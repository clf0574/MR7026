; generated by ARM C/C++ Compiler, 5.03 [Build 76]
; commandline ArmCC [--list --split_sections --debug -c --asm --interleave -o..\outupt\app_wireless.o --asm_dir=.\Flash\List\ --list_dir=.\Flash\List\ --depend=..\outupt\app_wireless.d --cpu=Cortex-M3 --apcs=interwork -O0 --diag_suppress=870 -I..\..\Libraries\CMSIS\Device\ST\STM32F10x\Include -I..\..\Libraries\STM32F10x_StdPeriph_Driver\inc -I..\..\Libraries\CMSIS\Include -I..\..\User\bsp -I..\..\User\bsp\inc -I..\..\User -IC:\Keil\ARM\RV31\INC -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\Inc\ST\STM32F10x -D__MICROLIB -DUSE_STDPERIPH_DRIVER -DSTM32F10X_HD --omf_browse=..\outupt\app_wireless.crf ..\..\User\App_Wireless.c]
                          THUMB

                          AREA ||i.Check_Wireless_Addr||, CODE, READONLY, ALIGN=2

                  Check_Wireless_Addr PROC
;;;1050   //检查收到的无线帧，是否在转发表中
;;;1051   void Check_Wireless_Addr(uint8_t *pbuf,uint8_t *rt)
000000  b578              PUSH     {r3-r6,lr}
;;;1052   {
000002  4602              MOV      r2,r0
;;;1053   	uint8_t i,buf[4],rtdat;
;;;1054   	
;;;1055   	buf[0]=*(pbuf+0);
000004  7814              LDRB     r4,[r2,#0]
000006  f88d4000          STRB     r4,[sp,#0]
;;;1056   	buf[1]=*(pbuf+1);	
00000a  7854              LDRB     r4,[r2,#1]
00000c  f88d4001          STRB     r4,[sp,#1]
;;;1057   	buf[2]=*(pbuf+2);
000010  7894              LDRB     r4,[r2,#2]
000012  f88d4002          STRB     r4,[sp,#2]
;;;1058   	buf[3]=*(pbuf+3);
000016  78d4              LDRB     r4,[r2,#3]
000018  f88d4003          STRB     r4,[sp,#3]
;;;1059   	rtdat=RE_ERR;
00001c  23ff              MOVS     r3,#0xff
;;;1060   	for(i=0;i<EX_TABLE_NUM;i++)
00001e  2000              MOVS     r0,#0
000020  e02b              B        |L1.122|
                  |L1.34|
;;;1061   	{
;;;1062   		if((buf[0]==Ex_Table.Exchange[i].wl_addr[0])&&(buf[1]==Ex_Table.Exchange[i].wl_addr[1])&&(buf[2]==Ex_Table.Exchange[i].wl_addr[2])&&(buf[3]==Ex_Table.Exchange[i].channel))
000022  f89d5000          LDRB     r5,[sp,#0]
000026  ebc006c0          RSB      r6,r0,r0,LSL #3
00002a  4c16              LDR      r4,|L1.132|
00002c  eb040446          ADD      r4,r4,r6,LSL #1
000030  78e4              LDRB     r4,[r4,#3]
000032  42a5              CMP      r5,r4
000034  d11f              BNE      |L1.118|
000036  f89d5001          LDRB     r5,[sp,#1]
00003a  ebc006c0          RSB      r6,r0,r0,LSL #3
00003e  4c11              LDR      r4,|L1.132|
000040  eb040446          ADD      r4,r4,r6,LSL #1
000044  7924              LDRB     r4,[r4,#4]
000046  42a5              CMP      r5,r4
000048  d115              BNE      |L1.118|
00004a  f89d5002          LDRB     r5,[sp,#2]
00004e  ebc006c0          RSB      r6,r0,r0,LSL #3
000052  4c0c              LDR      r4,|L1.132|
000054  eb040446          ADD      r4,r4,r6,LSL #1
000058  7964              LDRB     r4,[r4,#5]
00005a  42a5              CMP      r5,r4
00005c  d10b              BNE      |L1.118|
00005e  f89d5003          LDRB     r5,[sp,#3]
000062  ebc006c0          RSB      r6,r0,r0,LSL #3
000066  4c07              LDR      r4,|L1.132|
000068  eb040446          ADD      r4,r4,r6,LSL #1
00006c  79a4              LDRB     r4,[r4,#6]
00006e  42a5              CMP      r5,r4
000070  d101              BNE      |L1.118|
;;;1063   		//if((buf[0]==Ex_Table.Exchange[i].wl_addr[0])&&(buf[1]==Ex_Table.Exchange[i].wl_addr[1])&&(buf[2]==Ex_Table.Exchange[i].wl_addr[2]))
;;;1064   		{
;;;1065   			rtdat=i;
000072  4603              MOV      r3,r0
;;;1066   			break;									
000074  e003              B        |L1.126|
                  |L1.118|
000076  1c44              ADDS     r4,r0,#1              ;1060
000078  b2e0              UXTB     r0,r4                 ;1060
                  |L1.122|
00007a  2808              CMP      r0,#8                 ;1060
00007c  dbd1              BLT      |L1.34|
                  |L1.126|
00007e  bf00              NOP      
;;;1067   		}
;;;1068   	}
;;;1069   	*rt=rtdat;
000080  700b              STRB     r3,[r1,#0]
;;;1070   }
000082  bd78              POP      {r3-r6,pc}
;;;1071   
                          ENDP

                  |L1.132|
                          DCD      Ex_Table+0x36

                          AREA ||i.Check_WlLock_Addr||, CODE, READONLY, ALIGN=2

                  Check_WlLock_Addr PROC
;;;1073   //检查收到的无线帧，是否在转发表中
;;;1074   void Check_WlLock_Addr(uint8_t *pbuf,uint8_t *rt)
000000  b518              PUSH     {r3,r4,lr}
;;;1075   {
;;;1076   	uint8_t buf[4],rtdat;
;;;1077   	
;;;1078   	buf[0]=*(pbuf+0);
000002  7803              LDRB     r3,[r0,#0]
000004  f88d3000          STRB     r3,[sp,#0]
;;;1079   	buf[1]=*(pbuf+1);	
000008  7843              LDRB     r3,[r0,#1]
00000a  f88d3001          STRB     r3,[sp,#1]
;;;1080   	buf[2]=*(pbuf+2);
00000e  7883              LDRB     r3,[r0,#2]
000010  f88d3002          STRB     r3,[sp,#2]
;;;1081   	buf[3]=*(pbuf+3);
000014  78c3              LDRB     r3,[r0,#3]
000016  f88d3003          STRB     r3,[sp,#3]
;;;1082   	rtdat=RE_ERR;
00001a  22ff              MOVS     r2,#0xff
;;;1083   
;;;1084   	if((buf[0]==lock.item.addr[0])&&(buf[1]==lock.item.addr[1])&&(buf[2]==lock.item.addr[2])&&(buf[3]==lock.item.addr[3]))
00001c  f89d3000          LDRB     r3,[sp,#0]
000020  4c0c              LDR      r4,|L2.84|
000022  7ba4              LDRB     r4,[r4,#0xe]  ; lock
000024  42a3              CMP      r3,r4
000026  d112              BNE      |L2.78|
000028  f89d4001          LDRB     r4,[sp,#1]
00002c  4b09              LDR      r3,|L2.84|
00002e  7bdb              LDRB     r3,[r3,#0xf]
000030  429c              CMP      r4,r3
000032  d10c              BNE      |L2.78|
000034  f89d4002          LDRB     r4,[sp,#2]
000038  4b06              LDR      r3,|L2.84|
00003a  7c1b              LDRB     r3,[r3,#0x10]
00003c  429c              CMP      r4,r3
00003e  d106              BNE      |L2.78|
000040  f89d4003          LDRB     r4,[sp,#3]
000044  4b03              LDR      r3,|L2.84|
000046  7c5b              LDRB     r3,[r3,#0x11]
000048  429c              CMP      r4,r3
00004a  d100              BNE      |L2.78|
;;;1085   	{
;;;1086   		rtdat=0;								
00004c  2200              MOVS     r2,#0
                  |L2.78|
;;;1087   	}
;;;1088   	
;;;1089   	*rt=rtdat;
00004e  700a              STRB     r2,[r1,#0]
;;;1090   }
000050  bd18              POP      {r3,r4,pc}
;;;1091   //=============================================================================================
                          ENDP

000052  0000              DCW      0x0000
                  |L2.84|
                          DCD      lock

                          AREA ||i.SumCheck||, CODE, READONLY, ALIGN=1

                  SumCheck PROC
;;;1038   //累加和校验
;;;1039   uint8_t  SumCheck(uint8_t *p,uint8_t length)
000000  b510              PUSH     {r4,lr}
;;;1040   {
000002  4602              MOV      r2,r0
000004  460b              MOV      r3,r1
;;;1041   		uint8_t  i;
;;;1042   		uint8_t sum=0;
000006  2000              MOVS     r0,#0
;;;1043   		for(i=0;i<length;i++)
000008  2100              MOVS     r1,#0
00000a  e004              B        |L3.22|
                  |L3.12|
;;;1044   		{
;;;1045   			 sum+=p[i];
00000c  5c54              LDRB     r4,[r2,r1]
00000e  4404              ADD      r4,r4,r0
000010  b2e0              UXTB     r0,r4
000012  1c4c              ADDS     r4,r1,#1              ;1043
000014  b2e1              UXTB     r1,r4                 ;1043
                  |L3.22|
000016  4299              CMP      r1,r3                 ;1043
000018  dbf8              BLT      |L3.12|
;;;1046   		}
;;;1047   		return sum;
;;;1048   }
00001a  bd10              POP      {r4,pc}
;;;1049   //=============================================================================================
                          ENDP


                          AREA ||i.Wireless_Control_IR||, CODE, READONLY, ALIGN=2

                  Wireless_Control_IR PROC
;;;939    //通过无线控制红外多媒体设备
;;;940    uint8_t Wireless_Control_IR(uint8_t index,uint8_t len,uint8_t *pdat)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;941    {
000004  4606              MOV      r6,r0
000006  460f              MOV      r7,r1
000008  4690              MOV      r8,r2
;;;942    				uint8_t i;
;;;943    				_Frame *pws;
;;;944    	      pws=GetQueue_InQ(&WirelessSend_Queue,index);	
00000a  4631              MOV      r1,r6
00000c  482d              LDR      r0,|L4.196|
00000e  f7fffffe          BL       GetQueue_InQ
000012  4604              MOV      r4,r0
;;;945    				if(pws==NULL)
000014  b914              CBNZ     r4,|L4.28|
;;;946    				{
;;;947    					return RE_ERR;
000016  20ff              MOVS     r0,#0xff
                  |L4.24|
;;;948    				}
;;;949    				
;;;950    				pws->buf[0]=0x10;
;;;951    				pws->buf[1]=0x45;
;;;952    				
;;;953    				//2017.11.16修改0为index
;;;954    				for(i=0;i<3;i++)pws->buf[2+i]=Ex_Table.Exchange[index].wl_addr[i]; //目标地址
;;;955    				pws->buf[5]=Ex_Table.Exchange[index].channel;
;;;956    				
;;;957    				for(i=0;i<4;i++)pws->buf[6+i]=Ir.TgAddr[i];											//54键遥控器地址	源地址
;;;958    				
;;;959    				if(len>3)len=3;
;;;960    				pws->buf[10]=len;
;;;961    				for(i=0;i<len;i++)pws->buf[11+i]=*(pdat+i);
;;;962    				
;;;963    				pws->buf[14]=Crc8CheckSum(pws->buf,14);
;;;964    				pws->buf[15]=SumCheck(pws->buf,14);
;;;965    				
;;;966    				pws->cnt=16;				//发送总的字节数
;;;967    				pws->flag=1;
;;;968    				pws->resend=1;				//重复上报三次	
;;;969    				pws->rand=1;				//第一次空闲既发送
;;;970    				pws->ackwait=2;	
;;;971    				//EnQueueBuf(&WirelessSend_Queue);
;;;972    				EnQueueBuf(&WirelessSend_Queue,index);//清队列
;;;973    				return RE_OK;
;;;974    }
000018  e8bd81f0          POP      {r4-r8,pc}
                  |L4.28|
00001c  2010              MOVS     r0,#0x10              ;950
00001e  7020              STRB     r0,[r4,#0]            ;950
000020  2045              MOVS     r0,#0x45              ;951
000022  7060              STRB     r0,[r4,#1]            ;951
000024  2500              MOVS     r5,#0                 ;954
000026  e00a              B        |L4.62|
                  |L4.40|
000028  ebc601c6          RSB      r1,r6,r6,LSL #3       ;954
00002c  4826              LDR      r0,|L4.200|
00002e  eb000041          ADD      r0,r0,r1,LSL #1       ;954
000032  1cc0              ADDS     r0,r0,#3              ;954
000034  5d41              LDRB     r1,[r0,r5]            ;954
000036  1ca8              ADDS     r0,r5,#2              ;954
000038  5421              STRB     r1,[r4,r0]            ;954
00003a  1c68              ADDS     r0,r5,#1              ;954
00003c  b2c5              UXTB     r5,r0                 ;954
                  |L4.62|
00003e  2d03              CMP      r5,#3                 ;954
000040  dbf2              BLT      |L4.40|
000042  ebc601c6          RSB      r1,r6,r6,LSL #3       ;955
000046  4820              LDR      r0,|L4.200|
000048  eb000041          ADD      r0,r0,r1,LSL #1       ;955
00004c  7980              LDRB     r0,[r0,#6]            ;955
00004e  7160              STRB     r0,[r4,#5]            ;955
000050  2500              MOVS     r5,#0                 ;957
000052  e005              B        |L4.96|
                  |L4.84|
000054  481d              LDR      r0,|L4.204|
000056  5d41              LDRB     r1,[r0,r5]            ;957
000058  1da8              ADDS     r0,r5,#6              ;957
00005a  5421              STRB     r1,[r4,r0]            ;957
00005c  1c68              ADDS     r0,r5,#1              ;957
00005e  b2c5              UXTB     r5,r0                 ;957
                  |L4.96|
000060  2d04              CMP      r5,#4                 ;957
000062  dbf7              BLT      |L4.84|
000064  2f03              CMP      r7,#3                 ;959
000066  dd00              BLE      |L4.106|
000068  2703              MOVS     r7,#3                 ;959
                  |L4.106|
00006a  72a7              STRB     r7,[r4,#0xa]          ;960
00006c  2500              MOVS     r5,#0                 ;961
00006e  e006              B        |L4.126|
                  |L4.112|
000070  f8181005          LDRB     r1,[r8,r5]            ;961
000074  f105000b          ADD      r0,r5,#0xb            ;961
000078  5421              STRB     r1,[r4,r0]            ;961
00007a  1c68              ADDS     r0,r5,#1              ;961
00007c  b2c5              UXTB     r5,r0                 ;961
                  |L4.126|
00007e  42bd              CMP      r5,r7                 ;961
000080  dbf6              BLT      |L4.112|
000082  210e              MOVS     r1,#0xe               ;963
000084  4620              MOV      r0,r4                 ;963
000086  f7fffffe          BL       Crc8CheckSum
00008a  73a0              STRB     r0,[r4,#0xe]          ;963
00008c  210e              MOVS     r1,#0xe               ;964
00008e  4620              MOV      r0,r4                 ;964
000090  f7fffffe          BL       SumCheck
000094  f10404ae          ADD      r4,r4,#0xae           ;964
000098  f8040c9f          STRB     r0,[r4,#-0x9f]        ;964
00009c  f04f0010          MOV      r0,#0x10              ;966
0000a0  76a0              STRB     r0,[r4,#0x1a]         ;966
0000a2  f04f0001          MOV      r0,#1                 ;967
0000a6  76e0              STRB     r0,[r4,#0x1b]         ;967
0000a8  7720              STRB     r0,[r4,#0x1c]         ;968
0000aa  77a0              STRB     r0,[r4,#0x1e]         ;969
0000ac  f04f0002          MOV      r0,#2                 ;970
0000b0  77e0              STRB     r0,[r4,#0x1f]         ;970
0000b2  f1a404ae          SUB      r4,r4,#0xae           ;970
0000b6  4631              MOV      r1,r6                 ;972
0000b8  4802              LDR      r0,|L4.196|
0000ba  f7fffffe          BL       EnQueueBuf
0000be  20fe              MOVS     r0,#0xfe              ;973
0000c0  e7aa              B        |L4.24|
;;;975    //======================================================================================
                          ENDP

0000c2  0000              DCW      0x0000
                  |L4.196|
                          DCD      WirelessSend_Queue
                  |L4.200|
                          DCD      Ex_Table+0x36
                  |L4.204|
                          DCD      ||Ir||+0x3

                          AREA ||i.Wireless_Data_Send||, CODE, READONLY, ALIGN=2

                  Wireless_Data_Send PROC
;;;1193   //控制无线设备动作
;;;1194   uint8_t Wireless_Data_Send(uint8_t *pt,uint8_t num)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;1195   {
000004  4606              MOV      r6,r0
000006  460f              MOV      r7,r1
;;;1196   				_Frame *pws;
;;;1197   	      uint8_t i;
;;;1198   
;;;1199   	      pws=GetQueue_InQ(&WirelessSend_Queue,0);	
000008  2100              MOVS     r1,#0
00000a  4827              LDR      r0,|L5.168|
00000c  f7fffffe          BL       GetQueue_InQ
000010  4604              MOV      r4,r0
;;;1200   				if(pws==NULL)
000012  b914              CBNZ     r4,|L5.26|
;;;1201   				{
;;;1202   					return RE_ERR;
000014  20ff              MOVS     r0,#0xff
                  |L5.22|
;;;1203   				}
;;;1204   				
;;;1205   				pws->buf[0]=0x30;
;;;1206   				pws->buf[1]=0x40;
;;;1207   				pws->buf[2]=0x01;				//目标地址
;;;1208   				pws->buf[3]=0x02;
;;;1209   				pws->buf[4]=0x03;
;;;1210   				pws->buf[5]=0x01;
;;;1211   				
;;;1212   				pws->buf[6]=0x11;				//源地址
;;;1213   				pws->buf[7]=0x12;
;;;1214   				pws->buf[8]=0x13;
;;;1215   				pws->buf[9]=0x11;
;;;1216   				
;;;1217   				pws->buf[10]=0x00;			 //同步数
;;;1218   				pws->buf[11]=0x01;
;;;1219   				
;;;1220   				pws->buf[12]=0xcf;			 //命令
;;;1221   				
;;;1222   				for(i=0;i<33;i++)pws->buf[13+i]=i;
;;;1223   				
;;;1224   				pws->buf[46]=Crc8CheckSum(pws->buf,46);
;;;1225   				pws->buf[47]=SumCheck(pws->buf,46);
;;;1226   				
;;;1227   				pws->cnt=48;				//发送总的字节数
;;;1228   				pws->flag=1;
;;;1229   				pws->resend=3;				//重复上报三次	
;;;1230   				pws->rand=0;				//第一次空闲既发送
;;;1231   				pws->ackwait=0;	
;;;1232   				EnQueueBuf(&WirelessSend_Queue,0);//清队列
;;;1233   				return RE_OK;
;;;1234   }
000016  e8bd81f0          POP      {r4-r8,pc}
                  |L5.26|
00001a  2030              MOVS     r0,#0x30              ;1205
00001c  7020              STRB     r0,[r4,#0]            ;1205
00001e  2040              MOVS     r0,#0x40              ;1206
000020  7060              STRB     r0,[r4,#1]            ;1206
000022  2001              MOVS     r0,#1                 ;1207
000024  70a0              STRB     r0,[r4,#2]            ;1207
000026  2002              MOVS     r0,#2                 ;1208
000028  70e0              STRB     r0,[r4,#3]            ;1208
00002a  2003              MOVS     r0,#3                 ;1209
00002c  7120              STRB     r0,[r4,#4]            ;1209
00002e  2001              MOVS     r0,#1                 ;1210
000030  7160              STRB     r0,[r4,#5]            ;1210
000032  2011              MOVS     r0,#0x11              ;1212
000034  71a0              STRB     r0,[r4,#6]            ;1212
000036  2012              MOVS     r0,#0x12              ;1213
000038  71e0              STRB     r0,[r4,#7]            ;1213
00003a  2013              MOVS     r0,#0x13              ;1214
00003c  7220              STRB     r0,[r4,#8]            ;1214
00003e  2011              MOVS     r0,#0x11              ;1215
000040  7260              STRB     r0,[r4,#9]            ;1215
000042  2000              MOVS     r0,#0                 ;1217
000044  72a0              STRB     r0,[r4,#0xa]          ;1217
000046  2001              MOVS     r0,#1                 ;1218
000048  72e0              STRB     r0,[r4,#0xb]          ;1218
00004a  20cf              MOVS     r0,#0xcf              ;1220
00004c  7320              STRB     r0,[r4,#0xc]          ;1220
00004e  2500              MOVS     r5,#0                 ;1222
000050  e004              B        |L5.92|
                  |L5.82|
000052  f105000d          ADD      r0,r5,#0xd            ;1222
000056  5425              STRB     r5,[r4,r0]            ;1222
000058  1c68              ADDS     r0,r5,#1              ;1222
00005a  b2c5              UXTB     r5,r0                 ;1222
                  |L5.92|
00005c  2d21              CMP      r5,#0x21              ;1222
00005e  dbf8              BLT      |L5.82|
000060  212e              MOVS     r1,#0x2e              ;1224
000062  4620              MOV      r0,r4                 ;1224
000064  f7fffffe          BL       Crc8CheckSum
000068  f884002e          STRB     r0,[r4,#0x2e]         ;1224
00006c  212e              MOVS     r1,#0x2e              ;1225
00006e  4620              MOV      r0,r4                 ;1225
000070  f7fffffe          BL       SumCheck
000074  f10404ae          ADD      r4,r4,#0xae           ;1225
000078  f8040c7f          STRB     r0,[r4,#-0x7f]        ;1225
00007c  f04f0030          MOV      r0,#0x30              ;1227
000080  76a0              STRB     r0,[r4,#0x1a]         ;1227
000082  f04f0001          MOV      r0,#1                 ;1228
000086  76e0              STRB     r0,[r4,#0x1b]         ;1228
000088  f04f0003          MOV      r0,#3                 ;1229
00008c  7720              STRB     r0,[r4,#0x1c]         ;1229
00008e  f04f0000          MOV      r0,#0                 ;1230
000092  77a0              STRB     r0,[r4,#0x1e]         ;1230
000094  77e0              STRB     r0,[r4,#0x1f]         ;1231
000096  f1a404ae          SUB      r4,r4,#0xae           ;1231
00009a  4601              MOV      r1,r0                 ;1232
00009c  4802              LDR      r0,|L5.168|
00009e  f7fffffe          BL       EnQueueBuf
0000a2  20fe              MOVS     r0,#0xfe              ;1233
0000a4  e7b7              B        |L5.22|
;;;1235   /***************************end  of  code ***************************/
                          ENDP

0000a6  0000              DCW      0x0000
                  |L5.168|
                          DCD      WirelessSend_Queue

                          AREA ||i.Wireless_Dev_Action||, CODE, READONLY, ALIGN=2

                  Wireless_Dev_Action PROC
;;;748    //控制无线设备动作
;;;749    uint8_t Wireless_Dev_Action(uint8_t index,uint8_t cmd,uint8_t route,uint8_t scene_num)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;750    {
000004  4606              MOV      r6,r0
000006  460d              MOV      r5,r1
000008  4617              MOV      r7,r2
00000a  4698              MOV      r8,r3
;;;751    				_Frame *pws;
;;;752    				//uint8_t addr_buf[4];
;;;753    					
;;;754    
;;;755    				//============================================================================
;;;756    				//检测设备类型
;;;757    				if(0==Wireless_Send_Check(cmd,index))return RE_ERR;
00000c  4631              MOV      r1,r6
00000e  4628              MOV      r0,r5
000010  f7fffffe          BL       Wireless_Send_Check
000014  b910              CBNZ     r0,|L6.28|
000016  20ff              MOVS     r0,#0xff
                  |L6.24|
;;;758    				
;;;759    				//pws=GetQueue_front(&WirelessSend_Queue);
;;;760    	      pws=GetQueue_InQ(&WirelessSend_Queue,index);	
;;;761    				if(pws==NULL)
;;;762    				{
;;;763    					return RE_ERR;
;;;764    				}
;;;765    				
;;;766    				pws->buf[0]=0x10;
;;;767    				pws->buf[1]=0x0b;
;;;768    				pws->buf[2]=cmd;
;;;769    				pws->buf[3]=scene_num;
;;;770    				
;;;771    				//pws->buf[4]=Dev.addr[0];
;;;772    				//pws->buf[5]=Dev.addr[1];
;;;773    				pws->buf[4]=Ex_Table.addr[0];
;;;774    				pws->buf[5]=Ex_Table.addr[1];
;;;775    				
;;;776    				pws->buf[6]=0x00;
;;;777    				
;;;778    				if((cmd==0x01)||(cmd==0x02))												//对码状态
;;;779    				{
;;;780    						pws->buf[7]=Exchangebuf.type;
;;;781    						pws->buf[8]=Exchangebuf.wl_addr[1];
;;;782    						pws->buf[9]=Exchangebuf.wl_addr[2];
;;;783    				}
;;;784    				else if(cmd==0x06)																//场景执行
;;;785    				{
;;;786    						pws->buf[7]=0xff;
;;;787    						pws->buf[8]=0xff;
;;;788    						pws->buf[9]=0xff;
;;;789    				}		
;;;790    				else
;;;791    				{
;;;792    						pws->buf[7]=Ex_Table.Exchange[index].type;
;;;793    						pws->buf[8]=Ex_Table.Exchange[index].wl_addr[1];
;;;794    						pws->buf[9]=Ex_Table.Exchange[index].wl_addr[2];
;;;795    				}
;;;796    				pws->buf[10]=0x01;
;;;797    				pws->buf[11]=route;
;;;798    				pws->buf[12]=0x00;
;;;799    				pws->buf[13]=0x00;
;;;800    				
;;;801    				pws->buf[14]=Crc8CheckSum(pws->buf,14);
;;;802    				pws->buf[15]=SumCheck(pws->buf,14);
;;;803    				
;;;804    				pws->cnt=16;				//发送总的字节数
;;;805    				pws->flag=1;
;;;806    				pws->resend=3;				//重复上报三次	
;;;807    				pws->rand=1;				//第一次空闲既发送
;;;808    				pws->ackwait=2;	
;;;809    				//EnQueueBuf(&WirelessSend_Queue);
;;;810    				EnQueueBuf(&WirelessSend_Queue,index);//清队列
;;;811    				return RE_OK;
;;;812    }
000018  e8bd81f0          POP      {r4-r8,pc}
                  |L6.28|
00001c  4631              MOV      r1,r6                 ;760
00001e  4836              LDR      r0,|L6.248|
000020  f7fffffe          BL       GetQueue_InQ
000024  4604              MOV      r4,r0                 ;760
000026  b90c              CBNZ     r4,|L6.44|
000028  20ff              MOVS     r0,#0xff              ;763
00002a  e7f5              B        |L6.24|
                  |L6.44|
00002c  2010              MOVS     r0,#0x10              ;766
00002e  7020              STRB     r0,[r4,#0]            ;766
000030  200b              MOVS     r0,#0xb               ;767
000032  7060              STRB     r0,[r4,#1]            ;767
000034  70a5              STRB     r5,[r4,#2]            ;768
000036  f8848003          STRB     r8,[r4,#3]            ;769
00003a  4830              LDR      r0,|L6.252|
00003c  7840              LDRB     r0,[r0,#1]            ;773  ; Ex_Table
00003e  7120              STRB     r0,[r4,#4]            ;773
000040  482e              LDR      r0,|L6.252|
000042  7880              LDRB     r0,[r0,#2]            ;774
000044  7160              STRB     r0,[r4,#5]            ;774
000046  2000              MOVS     r0,#0                 ;776
000048  71a0              STRB     r0,[r4,#6]            ;776
00004a  2d01              CMP      r5,#1                 ;778
00004c  d001              BEQ      |L6.82|
00004e  2d02              CMP      r5,#2                 ;778
000050  d109              BNE      |L6.102|
                  |L6.82|
000052  482b              LDR      r0,|L6.256|
000054  7800              LDRB     r0,[r0,#0]            ;780  ; Exchangebuf
000056  71e0              STRB     r0,[r4,#7]            ;780
000058  4829              LDR      r0,|L6.256|
00005a  7900              LDRB     r0,[r0,#4]            ;781
00005c  7220              STRB     r0,[r4,#8]            ;781
00005e  4828              LDR      r0,|L6.256|
000060  7940              LDRB     r0,[r0,#5]            ;782
000062  7260              STRB     r0,[r4,#9]            ;782
000064  e01d              B        |L6.162|
                  |L6.102|
000066  2d06              CMP      r5,#6                 ;784
000068  d104              BNE      |L6.116|
00006a  20ff              MOVS     r0,#0xff              ;786
00006c  71e0              STRB     r0,[r4,#7]            ;786
00006e  7220              STRB     r0,[r4,#8]            ;787
000070  7260              STRB     r0,[r4,#9]            ;788
000072  e016              B        |L6.162|
                  |L6.116|
000074  ebc601c6          RSB      r1,r6,r6,LSL #3       ;792
000078  4820              LDR      r0,|L6.252|
00007a  3036              ADDS     r0,r0,#0x36           ;792
00007c  f8100011          LDRB     r0,[r0,r1,LSL #1]     ;792
000080  71e0              STRB     r0,[r4,#7]            ;792
000082  ebc601c6          RSB      r1,r6,r6,LSL #3       ;793
000086  481d              LDR      r0,|L6.252|
000088  3036              ADDS     r0,r0,#0x36           ;793
00008a  eb000041          ADD      r0,r0,r1,LSL #1       ;793
00008e  7900              LDRB     r0,[r0,#4]            ;793
000090  7220              STRB     r0,[r4,#8]            ;793
000092  ebc601c6          RSB      r1,r6,r6,LSL #3       ;794
000096  4819              LDR      r0,|L6.252|
000098  3036              ADDS     r0,r0,#0x36           ;794
00009a  eb000041          ADD      r0,r0,r1,LSL #1       ;794
00009e  7940              LDRB     r0,[r0,#5]            ;794
0000a0  7260              STRB     r0,[r4,#9]            ;794
                  |L6.162|
0000a2  2001              MOVS     r0,#1                 ;796
0000a4  72a0              STRB     r0,[r4,#0xa]          ;796
0000a6  72e7              STRB     r7,[r4,#0xb]          ;797
0000a8  2000              MOVS     r0,#0                 ;798
0000aa  7320              STRB     r0,[r4,#0xc]          ;798
0000ac  7360              STRB     r0,[r4,#0xd]          ;799
0000ae  210e              MOVS     r1,#0xe               ;801
0000b0  4620              MOV      r0,r4                 ;801
0000b2  f7fffffe          BL       Crc8CheckSum
0000b6  73a0              STRB     r0,[r4,#0xe]          ;801
0000b8  210e              MOVS     r1,#0xe               ;802
0000ba  4620              MOV      r0,r4                 ;802
0000bc  f7fffffe          BL       SumCheck
0000c0  f10404ae          ADD      r4,r4,#0xae           ;802
0000c4  f8040c9f          STRB     r0,[r4,#-0x9f]        ;802
0000c8  f04f0010          MOV      r0,#0x10              ;804
0000cc  76a0              STRB     r0,[r4,#0x1a]         ;804
0000ce  f04f0001          MOV      r0,#1                 ;805
0000d2  76e0              STRB     r0,[r4,#0x1b]         ;805
0000d4  f04f0003          MOV      r0,#3                 ;806
0000d8  7720              STRB     r0,[r4,#0x1c]         ;806
0000da  f04f0001          MOV      r0,#1                 ;807
0000de  77a0              STRB     r0,[r4,#0x1e]         ;807
0000e0  f04f0002          MOV      r0,#2                 ;808
0000e4  77e0              STRB     r0,[r4,#0x1f]         ;808
0000e6  f1a404ae          SUB      r4,r4,#0xae           ;808
0000ea  4631              MOV      r1,r6                 ;810
0000ec  4802              LDR      r0,|L6.248|
0000ee  f7fffffe          BL       EnQueueBuf
0000f2  20fe              MOVS     r0,#0xfe              ;811
0000f4  e790              B        |L6.24|
;;;813    //======================================================================================================
                          ENDP

0000f6  0000              DCW      0x0000
                  |L6.248|
                          DCD      WirelessSend_Queue
                  |L6.252|
                          DCD      Ex_Table
                  |L6.256|
                          DCD      Exchangebuf

                          AREA ||i.Wireless_Learn_Finish||, CODE, READONLY, ALIGN=2

                  Wireless_Learn_Finish PROC
;;;681    //学习设备完成-遥控器
;;;682    void Wireless_Learn_Finish(void)
000000  b57c              PUSH     {r2-r6,lr}
;;;683    {
;;;684    			uint8_t index,i,buf[4];
;;;685    			index=Exchangebuf.addr;
000002  4830              LDR      r0,|L7.196|
000004  7845              LDRB     r5,[r0,#1]  ; Exchangebuf
;;;686    			Exchangebuf.wl_addr[0]=wbuf[6];
000006  4830              LDR      r0,|L7.200|
000008  7980              LDRB     r0,[r0,#6]  ; wbuf
00000a  492e              LDR      r1,|L7.196|
00000c  70c8              STRB     r0,[r1,#3]
;;;687    			Exchangebuf.wl_addr[1]=wbuf[7];
00000e  482e              LDR      r0,|L7.200|
000010  79c1              LDRB     r1,[r0,#7]  ; wbuf
000012  482c              LDR      r0,|L7.196|
000014  7101              STRB     r1,[r0,#4]
;;;688    			Exchangebuf.wl_addr[2]=wbuf[8];
000016  482c              LDR      r0,|L7.200|
000018  7a01              LDRB     r1,[r0,#8]  ; wbuf
00001a  482a              LDR      r0,|L7.196|
00001c  7141              STRB     r1,[r0,#5]
;;;689    			Exchangebuf.channel   =wbuf[9];	
00001e  482a              LDR      r0,|L7.200|
000020  7a40              LDRB     r0,[r0,#9]  ; wbuf
000022  4928              LDR      r1,|L7.196|
000024  7188              STRB     r0,[r1,#6]
;;;690    	    Exchangebuf.wltype=wbuf[WL_CMD];				//遥控器类型
000026  4828              LDR      r0,|L7.200|
000028  7b00              LDRB     r0,[r0,#0xc]  ; wbuf
00002a  71c8              STRB     r0,[r1,#7]
;;;691    	
;;;692    			if((Exchangebuf.key!=0x00)&&(Exchangebuf.key!=0xff)&&(wbuf[WL_DAT]!=0x00)&&(wbuf[WL_DAT]!=0xff))Exchangebuf.key=wbuf[WL_DAT];						//遥控器按键个数
00002c  4608              MOV      r0,r1
00002e  7a00              LDRB     r0,[r0,#8]  ; Exchangebuf
000030  b170              CBZ      r0,|L7.80|
000032  4608              MOV      r0,r1
000034  7a00              LDRB     r0,[r0,#8]  ; Exchangebuf
000036  28ff              CMP      r0,#0xff
000038  d00a              BEQ      |L7.80|
00003a  4823              LDR      r0,|L7.200|
00003c  7b40              LDRB     r0,[r0,#0xd]  ; wbuf
00003e  b138              CBZ      r0,|L7.80|
000040  4821              LDR      r0,|L7.200|
000042  7b40              LDRB     r0,[r0,#0xd]  ; wbuf
000044  28ff              CMP      r0,#0xff
000046  d003              BEQ      |L7.80|
000048  481f              LDR      r0,|L7.200|
00004a  7b40              LDRB     r0,[r0,#0xd]  ; wbuf
00004c  7208              STRB     r0,[r1,#8]
00004e  e002              B        |L7.86|
                  |L7.80|
;;;693    			else Exchangebuf.key=0x04;
000050  2004              MOVS     r0,#4
000052  491c              LDR      r1,|L7.196|
000054  7208              STRB     r0,[r1,#8]
                  |L7.86|
;;;694    				
;;;695    	    for(i=0;i<4;i++)buf[i]=wbuf[6+i];
000056  2400              MOVS     r4,#0
000058  e006              B        |L7.104|
                  |L7.90|
00005a  1da0              ADDS     r0,r4,#6
00005c  491a              LDR      r1,|L7.200|
00005e  5c08              LDRB     r0,[r1,r0]
000060  a901              ADD      r1,sp,#4
000062  5508              STRB     r0,[r1,r4]
000064  1c60              ADDS     r0,r4,#1
000066  b2c4              UXTB     r4,r0
                  |L7.104|
000068  2c04              CMP      r4,#4
00006a  dbf6              BLT      |L7.90|
;;;696    	    buf[3]&=0xf0;
00006c  f89d0007          LDRB     r0,[sp,#7]
000070  f00000f0          AND      r0,r0,#0xf0
000074  f88d0007          STRB     r0,[sp,#7]
;;;697    			Exchangebuf.secret=GetSecret(&buf[0],4);
000078  2104              MOVS     r1,#4
00007a  a801              ADD      r0,sp,#4
00007c  f7fffffe          BL       GetSecret
000080  4910              LDR      r1,|L7.196|
000082  7308              STRB     r0,[r1,#0xc]
;;;698    			Exchangebuf.sync=0;
000084  2000              MOVS     r0,#0
000086  8148              STRH     r0,[r1,#0xa]
;;;699    			//写入到转换表
;;;700    			Write_Ex_Table(index);
000088  4628              MOV      r0,r5
00008a  f7fffffe          BL       Write_Ex_Table
;;;701    	
;;;702    			Remote_Key_En(index,0xff);
00008e  21ff              MOVS     r1,#0xff
000090  4628              MOV      r0,r5
000092  f7fffffe          BL       Remote_Key_En
;;;703    			IT1_Dev_Declare(index,0xbb);				//clf add 20171121
000096  21bb              MOVS     r1,#0xbb
000098  4628              MOV      r0,r5
00009a  f7fffffe          BL       IT1_Dev_Declare
;;;704    			//============================================================================
;;;705    			//LED指示
;;;706    			Led_set(1,25,25,8,2);	
00009e  2002              MOVS     r0,#2
0000a0  2308              MOVS     r3,#8
0000a2  2219              MOVS     r2,#0x19
0000a4  4611              MOV      r1,r2
0000a6  9000              STR      r0,[sp,#0]
0000a8  2001              MOVS     r0,#1
0000aa  f7fffffe          BL       Led_set
;;;707    			
;;;708    			Dev.learn_time=0;
0000ae  2000              MOVS     r0,#0
0000b0  4906              LDR      r1,|L7.204|
0000b2  72c8              STRB     r0,[r1,#0xb]
;;;709    			Dev.encode_time=0;
0000b4  7308              STRB     r0,[r1,#0xc]
;;;710    			Dev.stu=DEV_NORMAL;
0000b6  2002              MOVS     r0,#2
0000b8  7188              STRB     r0,[r1,#6]
;;;711    			Ex_Table.SyncErr[index]=0;
0000ba  2100              MOVS     r1,#0
0000bc  4804              LDR      r0,|L7.208|
0000be  5541              STRB     r1,[r0,r5]
;;;712    }
0000c0  bd7c              POP      {r2-r6,pc}
;;;713    
                          ENDP

0000c2  0000              DCW      0x0000
                  |L7.196|
                          DCD      Exchangebuf
                  |L7.200|
                          DCD      wbuf
                  |L7.204|
                          DCD      ||Dev||
                  |L7.208|
                          DCD      Ex_Table+0xe

                          AREA ||i.Wireless_Lock_Action||, CODE, READONLY, ALIGN=2

                  Wireless_Lock_Action PROC
;;;815    //控制锁
;;;816    uint8_t Wireless_Lock_Action(uint8_t index,uint8_t cmd)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;817    {
000004  4606              MOV      r6,r0
000006  460f              MOV      r7,r1
;;;818    				_Frame *pws;
;;;819    				uint8_t i/*,len*/;
;;;820    
;;;821    	      pws=GetQueue_InQ(&WirelessSend_Queue,index);	
000008  4631              MOV      r1,r6
00000a  487b              LDR      r0,|L8.504|
00000c  f7fffffe          BL       GetQueue_InQ
000010  4604              MOV      r4,r0
;;;822    				if(pws==NULL){return RE_ERR;}
000012  b914              CBNZ     r4,|L8.26|
000014  20ff              MOVS     r0,#0xff
                  |L8.22|
;;;823    				
;;;824    				pws->buf[0]=0x20;								//帧长度
;;;825    				pws->buf[1]=0x30;								//帧类型
;;;826    				for(i=0;i<4;i++)pws->buf[2+i]=lock.item.addr[i];			//目标地址
;;;827    				for(i=0;i<4;i++)pws->buf[6+i]=Ex_Table.addr[i];							//源地址
;;;828    				//pws->buf[6+0]=0x76;
;;;829    				//pws->buf[6+1]=0xa1;
;;;830    				//pws->buf[6+2]=0xe9;
;;;831    				//pws->buf[6+3]=0x01;
;;;832    				
;;;833    				pws->buf[10]=(uint8_t)(Dev.sync>>8);
;;;834    				pws->buf[11]=(uint8_t)(Dev.sync&0x00ff);
;;;835    				Dev.sync++;
;;;836    				
;;;837    				if(cmd==0x01)										//开锁
;;;838    				{
;;;839    							pws->buf[12]=3;
;;;840    						  pws->buf[13]=0x02;
;;;841    					    pws->buf[14]=0x06;
;;;842    							pws->buf[15]=0x00;
;;;843    							for(i=0;i<13;i++)pws->buf[16+i]=0xff;
;;;844    				}
;;;845    				else if(cmd==0x02)							//关锁
;;;846    				{
;;;847    //							pws->buf[12]=4;
;;;848    //						  pws->buf[13]=0x01;
;;;849    //					    pws->buf[14]=0x0a;
;;;850    //							pws->buf[15]=0x00;
;;;851    //					    pws->buf[16]=0x03;
;;;852    //							for(i=0;i<12;i++)pws->buf[17+i]=0xff;
;;;853    					    pws->buf[12]=3;
;;;854    						  pws->buf[13]=0x02;
;;;855    					    pws->buf[14]=0x06;
;;;856    							pws->buf[15]=0x01;
;;;857    							for(i=0;i<13;i++)pws->buf[16+i]=0xff;
;;;858    				}
;;;859    				else if(cmd==0xbb)							//添加指纹
;;;860    				{
;;;861    							pws->buf[12]=4;
;;;862    						  pws->buf[13]=0x02;
;;;863    					    pws->buf[14]=0x07;
;;;864    							pws->buf[15]=index;
;;;865    					    pws->buf[16]=0x18;
;;;866    							for(i=0;i<12;i++)pws->buf[17+i]=0xff;
;;;867    				}
;;;868    				else if(cmd==0xcc)							//删除指纹
;;;869    				{
;;;870    					    if((index==0)||(index>16))return 0;
;;;871    							pws->buf[12]=4;
;;;872    						  pws->buf[13]=0x02;
;;;873    					    pws->buf[14]=0x08;
;;;874    					    pws->buf[15]=(uint8_t)(lock.item.Serail[index-1]&0x00ff);
;;;875    					    pws->buf[16]=(uint8_t)(lock.item.Serail[index-1]>>8);
;;;876    							for(i=0;i<12;i++)pws->buf[17+i]=0xff;
;;;877    				}
;;;878    				//测试指令
;;;879    				else if(cmd==0xcf)
;;;880    				{
;;;881    							pws->buf[0]=0x10;								//帧长度
;;;882    							pws->buf[1]=0x30;								//帧类型
;;;883    							for(i=0;i<4;i++)pws->buf[2+i]=0xff;			//目标地址
;;;884    							for(i=0;i<4;i++)pws->buf[6+i]=0xcc;							//源地址
;;;885    							
;;;886    							pws->buf[10]=0xcf;
;;;887    							pws->buf[11]=0xcf;
;;;888    					    pws->buf[12]=0xcf;
;;;889    					    pws->buf[13]=0xcf;
;;;890    							//======================================================================
;;;891    							//在这里加密
;;;892    					    #ifdef USE_DS28E02
;;;893    							ComposePacketFromDS28E02(&(pws->buf[6]),&(pws->buf[10]),4,1);
;;;894    					    #endif
;;;895    							//======================================================================
;;;896    					
;;;897    					    pws->buf[14]=Crc8CheckSum(pws->buf,14);
;;;898    							pws->buf[15]=SumCheck(pws->buf,14);
;;;899    							
;;;900    							pws->cnt=16;				//发送总的字节数
;;;901    							pws->flag=1;
;;;902    							pws->resend=3;				//重复上报三次	
;;;903    							pws->rand=1;				//第一次空闲既发送
;;;904    							pws->ackwait=2;	
;;;905    							EnQueueBuf(&WirelessSend_Queue,index);//清队列
;;;906    							return RE_OK;
;;;907    					
;;;908    				}
;;;909    				else
;;;910    				{
;;;911    						return 0;
;;;912    				}
;;;913    				//======================================================================
;;;914    				//在这里加密
;;;915    				#ifdef USE_LOCK_BY_DS28E11
;;;916    				#ifdef USE_DS28E02
;;;917    				ComposePacketFromDS28E02(&(pws->buf[6]),&(pws->buf[10]),4,1);
;;;918    				#else
;;;919    				ComposePacketFromDS28E02(&(pws->buf[6]),&(pws->buf[10]),4,1);
;;;920    				#endif
;;;921    				
;;;922    				#endif
;;;923    				//======================================================================
;;;924    				
;;;925    				pws->buf[30]=Crc8CheckSum(pws->buf,30);
;;;926    				pws->buf[31]=SumCheck(pws->buf,30);
;;;927    				
;;;928    				pws->cnt=32;				//发送总的字节数
;;;929    				pws->flag=1;
;;;930    				pws->resend=5;				//重复上报三次	
;;;931    				pws->rand=1;				//第一次空闲既发送
;;;932    				pws->ackwait=2;	
;;;933    				EnQueueBuf(&WirelessSend_Queue,index);//清队列
;;;934    				return RE_OK;
;;;935    }
000016  e8bd81f0          POP      {r4-r8,pc}
                  |L8.26|
00001a  2020              MOVS     r0,#0x20              ;824
00001c  7020              STRB     r0,[r4,#0]            ;824
00001e  2030              MOVS     r0,#0x30              ;825
000020  7060              STRB     r0,[r4,#1]            ;825
000022  2500              MOVS     r5,#0                 ;826
000024  e005              B        |L8.50|
                  |L8.38|
000026  4875              LDR      r0,|L8.508|
000028  5d41              LDRB     r1,[r0,r5]            ;826
00002a  1ca8              ADDS     r0,r5,#2              ;826
00002c  5421              STRB     r1,[r4,r0]            ;826
00002e  1c68              ADDS     r0,r5,#1              ;826
000030  b2c5              UXTB     r5,r0                 ;826
                  |L8.50|
000032  2d04              CMP      r5,#4                 ;826
000034  dbf7              BLT      |L8.38|
000036  2500              MOVS     r5,#0                 ;827
000038  e005              B        |L8.70|
                  |L8.58|
00003a  4871              LDR      r0,|L8.512|
00003c  5d41              LDRB     r1,[r0,r5]            ;827
00003e  1da8              ADDS     r0,r5,#6              ;827
000040  5421              STRB     r1,[r4,r0]            ;827
000042  1c68              ADDS     r0,r5,#1              ;827
000044  b2c5              UXTB     r5,r0                 ;827
                  |L8.70|
000046  2d04              CMP      r5,#4                 ;827
000048  dbf7              BLT      |L8.58|
00004a  486e              LDR      r0,|L8.516|
00004c  8a00              LDRH     r0,[r0,#0x10]         ;833  ; Dev
00004e  1200              ASRS     r0,r0,#8              ;833
000050  72a0              STRB     r0,[r4,#0xa]          ;833
000052  486c              LDR      r0,|L8.516|
000054  7c00              LDRB     r0,[r0,#0x10]         ;834  ; Dev
000056  72e0              STRB     r0,[r4,#0xb]          ;834
000058  486a              LDR      r0,|L8.516|
00005a  8a00              LDRH     r0,[r0,#0x10]         ;835  ; Dev
00005c  1c40              ADDS     r0,r0,#1              ;835
00005e  4969              LDR      r1,|L8.516|
000060  8208              STRH     r0,[r1,#0x10]         ;835
000062  2f01              CMP      r7,#1                 ;837
000064  d112              BNE      |L8.140|
000066  2003              MOVS     r0,#3                 ;839
000068  7320              STRB     r0,[r4,#0xc]          ;839
00006a  2002              MOVS     r0,#2                 ;840
00006c  7360              STRB     r0,[r4,#0xd]          ;840
00006e  2006              MOVS     r0,#6                 ;841
000070  73a0              STRB     r0,[r4,#0xe]          ;841
000072  2000              MOVS     r0,#0                 ;842
000074  73e0              STRB     r0,[r4,#0xf]          ;842
000076  2500              MOVS     r5,#0                 ;843
000078  e005              B        |L8.134|
                  |L8.122|
00007a  21ff              MOVS     r1,#0xff              ;843
00007c  f1050010          ADD      r0,r5,#0x10           ;843
000080  5421              STRB     r1,[r4,r0]            ;843
000082  1c68              ADDS     r0,r5,#1              ;843
000084  b2c5              UXTB     r5,r0                 ;843
                  |L8.134|
000086  2d0d              CMP      r5,#0xd               ;843
000088  dbf7              BLT      |L8.122|
00008a  e091              B        |L8.432|
                  |L8.140|
00008c  2f02              CMP      r7,#2                 ;845
00008e  d112              BNE      |L8.182|
000090  2003              MOVS     r0,#3                 ;853
000092  7320              STRB     r0,[r4,#0xc]          ;853
000094  2002              MOVS     r0,#2                 ;854
000096  7360              STRB     r0,[r4,#0xd]          ;854
000098  2006              MOVS     r0,#6                 ;855
00009a  73a0              STRB     r0,[r4,#0xe]          ;855
00009c  2001              MOVS     r0,#1                 ;856
00009e  73e0              STRB     r0,[r4,#0xf]          ;856
0000a0  2500              MOVS     r5,#0                 ;857
0000a2  e005              B        |L8.176|
                  |L8.164|
0000a4  21ff              MOVS     r1,#0xff              ;857
0000a6  f1050010          ADD      r0,r5,#0x10           ;857
0000aa  5421              STRB     r1,[r4,r0]            ;857
0000ac  1c68              ADDS     r0,r5,#1              ;857
0000ae  b2c5              UXTB     r5,r0                 ;857
                  |L8.176|
0000b0  2d0d              CMP      r5,#0xd               ;857
0000b2  dbf7              BLT      |L8.164|
0000b4  e07c              B        |L8.432|
                  |L8.182|
0000b6  2fbb              CMP      r7,#0xbb              ;859
0000b8  d113              BNE      |L8.226|
0000ba  2004              MOVS     r0,#4                 ;861
0000bc  7320              STRB     r0,[r4,#0xc]          ;861
0000be  2002              MOVS     r0,#2                 ;862
0000c0  7360              STRB     r0,[r4,#0xd]          ;862
0000c2  2007              MOVS     r0,#7                 ;863
0000c4  73a0              STRB     r0,[r4,#0xe]          ;863
0000c6  73e6              STRB     r6,[r4,#0xf]          ;864
0000c8  2018              MOVS     r0,#0x18              ;865
0000ca  7420              STRB     r0,[r4,#0x10]         ;865
0000cc  2500              MOVS     r5,#0                 ;866
0000ce  e005              B        |L8.220|
                  |L8.208|
0000d0  21ff              MOVS     r1,#0xff              ;866
0000d2  f1050011          ADD      r0,r5,#0x11           ;866
0000d6  5421              STRB     r1,[r4,r0]            ;866
0000d8  1c68              ADDS     r0,r5,#1              ;866
0000da  b2c5              UXTB     r5,r0                 ;866
                  |L8.220|
0000dc  2d0c              CMP      r5,#0xc               ;866
0000de  dbf7              BLT      |L8.208|
0000e0  e066              B        |L8.432|
                  |L8.226|
0000e2  2fcc              CMP      r7,#0xcc              ;868
0000e4  d121              BNE      |L8.298|
0000e6  b10e              CBZ      r6,|L8.236|
0000e8  2e10              CMP      r6,#0x10              ;870
0000ea  dd01              BLE      |L8.240|
                  |L8.236|
0000ec  2000              MOVS     r0,#0                 ;870
0000ee  e792              B        |L8.22|
                  |L8.240|
0000f0  2004              MOVS     r0,#4                 ;871
0000f2  7320              STRB     r0,[r4,#0xc]          ;871
0000f4  2002              MOVS     r0,#2                 ;872
0000f6  7360              STRB     r0,[r4,#0xd]          ;872
0000f8  2008              MOVS     r0,#8                 ;873
0000fa  73a0              STRB     r0,[r4,#0xe]          ;873
0000fc  1e71              SUBS     r1,r6,#1              ;874
0000fe  483f              LDR      r0,|L8.508|
000100  3016              ADDS     r0,r0,#0x16           ;874
000102  f8100011          LDRB     r0,[r0,r1,LSL #1]     ;874
000106  73e0              STRB     r0,[r4,#0xf]          ;874
000108  483c              LDR      r0,|L8.508|
00010a  3016              ADDS     r0,r0,#0x16           ;875
00010c  f8300011          LDRH     r0,[r0,r1,LSL #1]     ;875
000110  1200              ASRS     r0,r0,#8              ;875
000112  7420              STRB     r0,[r4,#0x10]         ;875
000114  2500              MOVS     r5,#0                 ;876
000116  e005              B        |L8.292|
                  |L8.280|
000118  21ff              MOVS     r1,#0xff              ;876
00011a  f1050011          ADD      r0,r5,#0x11           ;876
00011e  5421              STRB     r1,[r4,r0]            ;876
000120  1c68              ADDS     r0,r5,#1              ;876
000122  b2c5              UXTB     r5,r0                 ;876
                  |L8.292|
000124  2d0c              CMP      r5,#0xc               ;876
000126  dbf7              BLT      |L8.280|
000128  e042              B        |L8.432|
                  |L8.298|
00012a  2fcf              CMP      r7,#0xcf              ;879
00012c  d13e              BNE      |L8.428|
00012e  2010              MOVS     r0,#0x10              ;881
000130  7020              STRB     r0,[r4,#0]            ;881
000132  2030              MOVS     r0,#0x30              ;882
000134  7060              STRB     r0,[r4,#1]            ;882
000136  2500              MOVS     r5,#0                 ;883
000138  e004              B        |L8.324|
                  |L8.314|
00013a  21ff              MOVS     r1,#0xff              ;883
00013c  1ca8              ADDS     r0,r5,#2              ;883
00013e  5421              STRB     r1,[r4,r0]            ;883
000140  1c68              ADDS     r0,r5,#1              ;883
000142  b2c5              UXTB     r5,r0                 ;883
                  |L8.324|
000144  2d04              CMP      r5,#4                 ;883
000146  dbf8              BLT      |L8.314|
000148  2500              MOVS     r5,#0                 ;884
00014a  e004              B        |L8.342|
                  |L8.332|
00014c  21cc              MOVS     r1,#0xcc              ;884
00014e  1da8              ADDS     r0,r5,#6              ;884
000150  5421              STRB     r1,[r4,r0]            ;884
000152  1c68              ADDS     r0,r5,#1              ;884
000154  b2c5              UXTB     r5,r0                 ;884
                  |L8.342|
000156  2d04              CMP      r5,#4                 ;884
000158  dbf8              BLT      |L8.332|
00015a  20cf              MOVS     r0,#0xcf              ;886
00015c  72a0              STRB     r0,[r4,#0xa]          ;886
00015e  72e0              STRB     r0,[r4,#0xb]          ;887
000160  7320              STRB     r0,[r4,#0xc]          ;888
000162  7360              STRB     r0,[r4,#0xd]          ;889
000164  210e              MOVS     r1,#0xe               ;897
000166  4620              MOV      r0,r4                 ;897
000168  f7fffffe          BL       Crc8CheckSum
00016c  73a0              STRB     r0,[r4,#0xe]          ;897
00016e  210e              MOVS     r1,#0xe               ;898
000170  4620              MOV      r0,r4                 ;898
000172  f7fffffe          BL       SumCheck
000176  f10404ae          ADD      r4,r4,#0xae           ;898
00017a  f8040c9f          STRB     r0,[r4,#-0x9f]        ;898
00017e  f04f0010          MOV      r0,#0x10              ;900
000182  76a0              STRB     r0,[r4,#0x1a]         ;900
000184  f04f0001          MOV      r0,#1                 ;901
000188  76e0              STRB     r0,[r4,#0x1b]         ;901
00018a  f04f0003          MOV      r0,#3                 ;902
00018e  7720              STRB     r0,[r4,#0x1c]         ;902
000190  f04f0001          MOV      r0,#1                 ;903
000194  77a0              STRB     r0,[r4,#0x1e]         ;903
000196  f04f0002          MOV      r0,#2                 ;904
00019a  77e0              STRB     r0,[r4,#0x1f]         ;904
00019c  f1a404ae          SUB      r4,r4,#0xae           ;904
0001a0  4631              MOV      r1,r6                 ;905
0001a2  4815              LDR      r0,|L8.504|
0001a4  f7fffffe          BL       EnQueueBuf
0001a8  20fe              MOVS     r0,#0xfe              ;906
0001aa  e734              B        |L8.22|
                  |L8.428|
0001ac  2000              MOVS     r0,#0                 ;911
0001ae  e732              B        |L8.22|
                  |L8.432|
0001b0  211e              MOVS     r1,#0x1e              ;925
0001b2  4620              MOV      r0,r4                 ;925
0001b4  f7fffffe          BL       Crc8CheckSum
0001b8  77a0              STRB     r0,[r4,#0x1e]         ;925
0001ba  211e              MOVS     r1,#0x1e              ;926
0001bc  4620              MOV      r0,r4                 ;926
0001be  f7fffffe          BL       SumCheck
0001c2  f10404ae          ADD      r4,r4,#0xae           ;926
0001c6  f8040c8f          STRB     r0,[r4,#-0x8f]        ;926
0001ca  f04f0020          MOV      r0,#0x20              ;928
0001ce  76a0              STRB     r0,[r4,#0x1a]         ;928
0001d0  f04f0001          MOV      r0,#1                 ;929
0001d4  76e0              STRB     r0,[r4,#0x1b]         ;929
0001d6  f04f0005          MOV      r0,#5                 ;930
0001da  7720              STRB     r0,[r4,#0x1c]         ;930
0001dc  f04f0001          MOV      r0,#1                 ;931
0001e0  77a0              STRB     r0,[r4,#0x1e]         ;931
0001e2  f04f0002          MOV      r0,#2                 ;932
0001e6  77e0              STRB     r0,[r4,#0x1f]         ;932
0001e8  f1a404ae          SUB      r4,r4,#0xae           ;932
0001ec  4631              MOV      r1,r6                 ;933
0001ee  4802              LDR      r0,|L8.504|
0001f0  f7fffffe          BL       EnQueueBuf
0001f4  20fe              MOVS     r0,#0xfe              ;934
0001f6  e70e              B        |L8.22|
;;;936    
                          ENDP

                  |L8.504|
                          DCD      WirelessSend_Queue
                  |L8.508|
                          DCD      lock+0xe
                  |L8.512|
                          DCD      Ex_Table+0x1
                  |L8.516|
                          DCD      ||Dev||

                          AREA ||i.Wireless_Recv||, CODE, READONLY, ALIGN=2

                  Wireless_Recv PROC
;;;114    //走高优先级
;;;115    void Wireless_Recv(void)
000000  e92d4ff0          PUSH     {r4-r11,lr}
;;;116    {
000004  b08d              SUB      sp,sp,#0x34
;;;117    	_Frame *pws;
;;;118    	uint8_t i,tmp_sum,tmp_crc/*,tmp*/;
;;;119    	uint8_t index,cmd=0,dat,rt,recv_ok;
000006  f04f0a00          MOV      r10,#0
;;;120    	uint8_t len,buf[5];
;;;121    	uint8_t datlen;
;;;122    	uint8_t type;
;;;123    	uint16_t type_cmd,SyncNum;
;;;124    	static uint16_t CC1101_ResetTime=0;
;;;125    	static uint8_t step;
;;;126      uint8_t lin,row,tt;
;;;127    	
;;;128    	//无线帧过滤时间
;;;129    	if(dis_tim>0)dis_tim--;
00000a  48fe              LDR      r0,|L9.1028|
00000c  7800              LDRB     r0,[r0,#0]  ; dis_tim
00000e  2800              CMP      r0,#0
000010  dd04              BLE      |L9.28|
000012  48fc              LDR      r0,|L9.1028|
000014  7800              LDRB     r0,[r0,#0]  ; dis_tim
000016  1e40              SUBS     r0,r0,#1
000018  49fa              LDR      r1,|L9.1028|
00001a  7008              STRB     r0,[r1,#0]
                  |L9.28|
;;;130    	//用于监控CC1101是否工作
;;;131    	CC1101_ResetTime++;
00001c  48fa              LDR      r0,|L9.1032|
00001e  8800              LDRH     r0,[r0,#0]  ; CC1101_ResetTime
000020  1c40              ADDS     r0,r0,#1
000022  49f9              LDR      r1,|L9.1032|
000024  8008              STRH     r0,[r1,#0]
;;;132    	#ifdef USE_A7139
;;;133    	recv_ok=RF_RX(&wbuf[0],&len);
000026  a908              ADD      r1,sp,#0x20
000028  48f8              LDR      r0,|L9.1036|
00002a  f7fffffe          BL       RF_RX
00002e  9009              STR      r0,[sp,#0x24]
;;;134    	if((1==recv_ok)&&(len>=16))
000030  9809              LDR      r0,[sp,#0x24]
000032  2801              CMP      r0,#1
000034  d17e              BNE      |L9.308|
000036  f89d0020          LDRB     r0,[sp,#0x20]
00003a  2810              CMP      r0,#0x10
00003c  db7a              BLT      |L9.308|
;;;135    	#else
;;;136    	recv_ok=RfReceivePacket(&wbuf[0],&len); 
;;;137    	if((1==recv_ok)&&(len>=16))
;;;138    	#endif
;;;139    	//有接收数据
;;;140    	{
;;;141    					CC1101_ResetTime=0;
00003e  2000              MOVS     r0,#0
000040  49f1              LDR      r1,|L9.1032|
000042  8008              STRH     r0,[r1,#0]
;;;142    					//=============================================================
;;;143    					//数据校验
;;;144    					tmp_sum=SumCheck(&wbuf[0],(len-2));
000044  f89d0020          LDRB     r0,[sp,#0x20]
000048  1e80              SUBS     r0,r0,#2
00004a  b2c1              UXTB     r1,r0
00004c  48ef              LDR      r0,|L9.1036|
00004e  f7fffffe          BL       SumCheck
000052  900c              STR      r0,[sp,#0x30]
;;;145    					tmp_crc=Crc8CheckSum(&wbuf[0],(len-2));	
000054  f89d0020          LDRB     r0,[sp,#0x20]
000058  1e80              SUBS     r0,r0,#2
00005a  b2c1              UXTB     r1,r0
00005c  48eb              LDR      r0,|L9.1036|
00005e  f7fffffe          BL       Crc8CheckSum
000062  900b              STR      r0,[sp,#0x2c]
;;;146    					if((tmp_crc!=wbuf[len-2])||(tmp_sum!=wbuf[len-1]))return;
000064  f89d0020          LDRB     r0,[sp,#0x20]
000068  1e80              SUBS     r0,r0,#2
00006a  49e8              LDR      r1,|L9.1036|
00006c  5c09              LDRB     r1,[r1,r0]
00006e  980b              LDR      r0,[sp,#0x2c]
000070  4281              CMP      r1,r0
000072  d107              BNE      |L9.132|
000074  f89d0020          LDRB     r0,[sp,#0x20]
000078  1e40              SUBS     r0,r0,#1
00007a  49e4              LDR      r1,|L9.1036|
00007c  5c09              LDRB     r1,[r1,r0]
00007e  980c              LDR      r0,[sp,#0x30]
000080  4281              CMP      r1,r0
000082  d002              BEQ      |L9.138|
                  |L9.132|
;;;147    		      //=============================================================
;;;148    		      //串口直接输入功能==只用于调试，实际时应该屏蔽，禁止定义USE_SERIAL_DEBUG
;;;149    		      #ifdef USE_SERIAL_DEBUG
;;;150    					//ComposePacket(&wbuf[10],4,index);
;;;151    		      ComposePacketFromDS28E02(&wbuf[6],&wbuf[10],4,0);
;;;152    		      RS485_Send(wbuf,len);
;;;153    		      Led_set(1,25,25,1,2);
;;;154    		      Dev.stu=DEV_NORMAL;
;;;155    		      return;
;;;156    					#endif
;;;157    		      //==============================================================
;;;158    					//目标地址判断 是广播地址或者本身地址 则接收
;;;159    					rt=0;
;;;160    					for(i=0;i<4;i++){if(wbuf[2+i]!=0xff)rt++;}
;;;161    					if(rt!=0)
;;;162    					{
;;;163    							rt=0;
;;;164    							for(i=0;i<4;i++)if(wbuf[2+i]!=Ex_Table.addr[i])rt++;		
;;;165    					}
;;;166    					if(rt!=0)return;
;;;167    					//=============================================================
;;;168    					//源地址判断，是否保存	
;;;169    					if((Dev.type&0xf000)==0xb000)
;;;170    					{
;;;171    							Check_Wireless_Addr(&wbuf[6],&index);	
;;;172    					}
;;;173    					else if((Dev.type&0xf000)==0x3000)
;;;174    					{
;;;175    							Check_WlLock_Addr(&wbuf[6],&index);	
;;;176    					}
;;;177    					//=============================================================
;;;178    					//过滤同样的无线接收帧?
;;;179    					rt=Wireless_Recv_IsRun(&wbuf[0]);
;;;180    					if(rt!=OPT_OK)return;		
;;;181    					//=============================================================
;;;182    					if(index!=RE_ERR){Led_set(1,25,25,1,2);}
;;;183    					//=============================================================
;;;184    					//正常发送状态
;;;185    					if(Dev.stu==DEV_NORMAL)
;;;186    					{		
;;;187    								if(index==RE_ERR)return;
;;;188    								//=======================================================
;;;189    								if((wbuf[1]&0x80)==0x80)				//不需要解密
;;;190    								{
;;;191    												Wireless_Recv_Disable(&wbuf[0],150);			//在以后的100*5mS时间内，禁止处理同样的帧
;;;192    												//==============================================
;;;193    												//遥控器或传感器上报
;;;194    												if(wbuf[1]==0x11)
;;;195    												{															
;;;196    																if(Dev.profile==IT1)
;;;197    																{
;;;198    																	//54键和42键上报
;;;199    																	if((Ex_Table.Exchange[index].type==EX_KEY_54KEY)||(Ex_Table.Exchange[index].type==EX_KEY_42KEY))
;;;200    																	{
;;;201    																			cmd=wbuf[12];				//键值或命令
;;;202    																			dat=wbuf[13];				//模式或数据
;;;203    																			//IT1_RS485_DataLoad(index,cmd,dat);
;;;204    																		  IT1_Key_DataLoad(index,cmd,dat);
;;;205    																	}
;;;206    																	else if(Ex_Table.Exchange[index].type==EX_DEV_SUN)
;;;207    																	{
;;;208    																			buf[0]=2;
;;;209    																			buf[1]=wbuf[12];				//键值或命令
;;;210    																			buf[2]=wbuf[13];				//模式或数据
;;;211    																		  IT1_Sensor_DataLoad(index,&buf[0]);
;;;212    																	}
;;;213    																	else if(Ex_Table.Exchange[index].type==EX_DEV_SUN1)
;;;214    																	{
;;;215    																			buf[0]=2;
;;;216    																			buf[1]=wbuf[10];				//
;;;217    																			buf[2]=wbuf[11];				//
;;;218    																		  IT1_Sensor_DataLoad(index,&buf[0]);
;;;219    																	}
;;;220    																	else if((Ex_Table.Exchange[index].type==EX_KEY_NORMAL1)||(Ex_Table.Exchange[index].type==EX_KEY_FULL1))
;;;221    																	{
;;;222    																			cmd=wbuf[12]+1;				//键值或命令
;;;223    																			dat=wbuf[13];				//模式或数据
;;;224    																		  IT1_Key_DataLoad(index,cmd,dat);
;;;225    																	}
;;;226    																	else
;;;227    																	{
;;;228    																			len=wbuf[12];
;;;229    																	    for(i=0;i<len;i++)buf[i]=wbuf[12+i];
;;;230    																			IT1_RS485_StuLoad(index,len,&buf[0]);
;;;231    																	}
;;;232    																}
;;;233    												}
;;;234    												//===============================================================================
;;;235    												//旋转编码器遥控上报
;;;236    												else if(wbuf[1]==0x12)
;;;237    												{
;;;238    																SyncNum=(wbuf[10]<<8)+wbuf[11];
;;;239    																if(Ex_Table.SyncNum[index]==SyncNum)return;
;;;240    																Ex_Table.SyncNum[index]=SyncNum;
;;;241    																cmd=wbuf[12];				//键值或命令
;;;242    																dat=wbuf[13];				//模式或数据
;;;243    																IT1_Turn_DataLoad(index,cmd,0);
;;;244    																type_cmd=0;
;;;245    																type_cmd=0x01<<8;
;;;246    																type_cmd=type_cmd+cmd;
;;;247    																if(dat>0){dat--;while(dat>0){bsp_PutMsg(type_cmd,index);dat--;}}
;;;248    												}
;;;249    												//===============================================================================
;;;250    												//54键遥控器红外配置应答 共16个字节
;;;251    												else if((wbuf[1]==0x00)&&(Ir.wait==1)&&((wbuf[10]&0x0f)==Ir.serial))
;;;252    												{
;;;253    																pws=GetQueue_OutQ(&WirelessSend_Queue,&index);
;;;254    																//判断是否接收缓冲区为空
;;;255    																if(pws==NULL){return;}
;;;256    																
;;;257    																//这帧退出缓冲区，不在发送
;;;258    																for(i=0;i<pws->cnt;i++)pws->buf[i]=0x00;
;;;259    																pws->cnt=0;
;;;260    																pws->flag=0;
;;;261    																pws->ackwait=0;
;;;262    													
;;;263    																DeQueueBuf(&WirelessSend_Queue,index);
;;;264    																//运行再次装入红外数据
;;;265    																Ir.wait=0;																//2017.1.12
;;;266    												}
;;;267    												//=================================================================================
;;;268    												//红外配置完成后，DQ8028主动上报一次 DTM_IR_SETUP_FINISH
;;;269    												else if((wbuf[1]==DTM_IR_SETUP_FINISH)&&(Ir.flag==0))
;;;270    												{
;;;271    																//2017.4.5修改
;;;272    																Wireless_Recv_Disable(&wbuf[0],100);			//在以后的100*5mS时间内，禁止处理同样的帧
;;;273    													
;;;274    																 //比较DQ8010发来的累加和和缓冲区的累加和比较
;;;275    																 if((Ir.typechm==wbuf[10])&&(Ir.keychm==wbuf[11]))
;;;276    																 {
;;;277    																				IT1_IrSetup_Report(OPT_OK);
;;;278    																				Ir_Config_Add(index,Ir.cmd_key,Ir.key_mode);						//键值
;;;279    																 }
;;;280    																 else
;;;281    																 {
;;;282    																				IT1_IrSetup_Report(OPT_ERR);
;;;283    																 }
;;;284    												}
;;;285    												//=====================================================================================
;;;286    												//红外配置删除后，上报
;;;287    												else if((wbuf[1]==0x00)&&(wbuf[10]==Ir.serial)&&(wbuf[12]==MTD_IR_DEL))
;;;288    												{
;;;289    																Wireless_Recv_Disable(&wbuf[0],230);
;;;290    																IT1_IrDel_Report(index);
;;;291    																Ir_Config_Del(index,Ir.cmd_key,Ir.key_mode);					//键值
;;;292    												}
;;;293    												//=====================================================================================
;;;294    												//执行后返回的状态
;;;295    												else if((wbuf[1]==0xe0)||(wbuf[1]==0xe1))
;;;296    												{
;;;297    																Pannel_Table_Refresh(index,wbuf[1],&wbuf[10]);
;;;298    												}
;;;299    													
;;;300    									}
;;;301    									//==========================================================================================
;;;302    									//以下要用到解密程序 20171206新加
;;;303    									else
;;;304    									{
;;;305    												Wireless_Recv_Disable(&wbuf[0],250);			//在以后的100*5mS时间内，禁止处理同样的帧
;;;306    												//数据处理
;;;307    												if((Dev.type&0xf000)==0xb000)
;;;308    												{
;;;309    															//先解密，解密的秘钥在表格中
;;;310    															if(wbuf[1]!=0x00)
;;;311    															{
;;;312    																	datlen=len-12;
;;;313    																	ComposePacket(&wbuf[10],datlen,index);
;;;314    																	//比较同步数
;;;315    																	if(OPT_OK!=CompareSync(&wbuf[10],index))return;
;;;316    															}
;;;317    															//====================================================================================
;;;318    															//最高位表示是否要解密
;;;319    															//wbuf[1]=wbuf[1]&0x7f;
;;;320    															//wbuf[1] 为0x01 02 03 04 05 06 07 08 09时，明码
;;;321    															//旋转编码器遥控上报
;;;322    															if(wbuf[1]==0x12)
;;;323    															{
;;;324    																		SyncNum=(wbuf[10]<<8)+wbuf[11];
;;;325    																		if(Ex_Table.SyncNum[index]==SyncNum)return;
;;;326    																		Ex_Table.SyncNum[index]=SyncNum;
;;;327    																		cmd=wbuf[12];				//键值或命令
;;;328    																		dat=wbuf[13];				//模式或数据
;;;329    																		IT1_Turn_DataLoad(index,cmd,0);
;;;330    																
;;;331    																    //20180307 旋转时报开始调光和结束调光
;;;332    																    #if 0
;;;333    																		type_cmd=0;
;;;334    																		type_cmd=0x01<<8;
;;;335    																		type_cmd=type_cmd+cmd;
;;;336    																		if(dat>0){dat--;while(dat>0){bsp_PutMsg(type_cmd,index);dat--;}}
;;;337    																    #else
;;;338    																		type_cmd=0;
;;;339    																		type_cmd=0x01<<8;
;;;340    																		type_cmd=type_cmd+0x06;
;;;341    																    if((cmd==5)||(cmd==6))
;;;342    																		{
;;;343    																				bsp_PutMsg(type_cmd,index);
;;;344    																		}
;;;345    																    #endif
;;;346    															}
;;;347    															else if(wbuf[1]==0x11)
;;;348    															{
;;;349    																		cmd=wbuf[12]+1;				//键值或命令
;;;350    																		dat=wbuf[13];				//模式或数据
;;;351    																		IT1_Key_DataLoad(index,cmd,0x01);
;;;352    															}
;;;353    												}
;;;354    												//=============================================================================================
;;;355    												//以下处理锁转发器
;;;356    												else if((Dev.type&0xf000)==0x3000)
;;;357    												{
;;;358    															if(wbuf[1]!=0x00)
;;;359    															{
;;;360    																    #ifdef USE_LOCK_BY_DS28E11   //锁使用加密
;;;361    																		ComposePacketFromDS28E02(&wbuf[6],&wbuf[10],4,0);
;;;362    																		//比较同步数
;;;363    																		if(OPT_OK!=CompareSync(&wbuf[10],0))return;
;;;364    																    #endif
;;;365    															}
;;;366    															
;;;367    															//锁状态或指纹添加上报
;;;368    															//if((wbuf[1]==0x31)&&(wbuf[12]>0))
;;;369    															if(wbuf[1]==0x31)
;;;370    															{
;;;371    																		//20180328新修改指令
;;;372    																		if((wbuf[13]==0x03)&&(wbuf[14]==0x02))
;;;373    																		{
;;;374    																				type_cmd=wbuf[22]*256+wbuf[21];
;;;375    																			  for(i=0;i<LOCK_ITEMNUM;i++)
;;;376    																			  {
;;;377    																						if(lock.item.Serail[i]==type_cmd)break;
;;;378    																				}
;;;379    																				//保存有这个指纹的ID
;;;380    																				if(i<LOCK_ITEMNUM)
;;;381    																				{
;;;382    																						if(lock.waittime>0)
;;;383    																						{
;;;384    																									lock.waittime=0;
;;;385    																							    //如果已经保存，则上报上一个
;;;386    																							    IT1_Lock_DataLoad(i+1,0x02,0xbb);
;;;387    																						}
;;;388    																						else
;;;389    																						{
;;;390    																							    if((wbuf[23]==0x01)||(wbuf[23]==0x02)||(wbuf[23]==0x03)||((wbuf[23]==0x05)))
;;;391    																									{
;;;392    																													//先上报状态
;;;393    																													lock.item.stu|=0x01;
;;;394    																										      IT1_Lock_DataLoad(0,0x01,lock.item.stu); 
;;;395    																										      //触发上报
;;;396    																													lin=i/8;
;;;397    																													row=i%8;
;;;398    																													if((Pannel.item[0].onoffbuf[lin]&(0x01<<row))!=0x00)
;;;399    																													{
;;;400    																																//IT1_Lock_DataLoad(i+1,0x0,0x01);
;;;401    																														    tt=i+1;
;;;402    																														    DlyEvent_handle(tt,0,0x01,1000);
;;;403    																													}
;;;404    																													//如果有推送
;;;405    																													//if((Dev.mode&0x02)!=0x00)
;;;406    																													if((lock.item.safe!=0)||((lock.item.stu&0x02)!=0x00))
;;;407    																													{
;;;408    																														    DlyEvent_handle(0,0x03,0x05,1000);
;;;409    																													}
;;;410    																									}
;;;411    																									else if(wbuf[23]==0x00)
;;;412    																									{
;;;413    																										      //>>>>>=====================20180324 add=========
;;;414    																										      //先上报状态
;;;415    																										      lock.item.stu&=0xfe;
;;;416    																										      IT1_Lock_DataLoad(0,0x01,lock.item.stu);  
;;;417    																										      //触发上报
;;;418    																													lin=i/8;
;;;419    																													row=i%8;
;;;420    																													if((Pannel.item[0].onoffbuf[lin]&(0x01<<row))!=0x00)
;;;421    																													{
;;;422    																														    tt=i+1;
;;;423    																														    DlyEvent_handle(tt,0,0x00,1000);
;;;424    																													}
;;;425    																													//如果有推送
;;;426    																													//if((Dev.mode&0x02)!=0x00)
;;;427    																													if((lock.item.safe!=0)||((lock.item.stu&0x02)!=0x00))
;;;428    																													{
;;;429    																														    DlyEvent_handle(0,0x03,0x06,1000);
;;;430    																													}
;;;431    																													//<<<<<<<==========================================
;;;432    																									}
;;;433    																									else
;;;434    																									{
;;;435    																										
;;;436    																									}
;;;437    								
;;;438    																						}
;;;439    																				}
;;;440    																				//没有保存这个指纹ID
;;;441    																				else
;;;442    																				{
;;;443    																					 	//如果处于指纹添加状态
;;;444    																						if(lock.waittime>0)
;;;445    																						{
;;;446    																									lock.waittime=0;
;;;447    																									index=lock.index;
;;;448    																																														
;;;449    																							    if((wbuf[23]==0x01)||(wbuf[23]==0x02)||(wbuf[23]==0x03)||((wbuf[23]==0x05)))dat=0xbb;
;;;450    																							    else dat=0xff;
;;;451    																									
;;;452    																									
;;;453    																									IT1_Lock_DataLoad(index,0x02,dat);
;;;454    																									LockItem.Serail[lock.index-1]=(uint16_t)(wbuf[22]*256+wbuf[21]);    //用户编号+ID类型+用户类型;
;;;455    																									LockItem.IdType[lock.index-1]=0x00;
;;;456    																									LockItem.UserType[lock.index-1]=0x00;																		  
;;;457    																									Write_Lock_Table(lock.index);
;;;458    																						}
;;;459    																						else
;;;460    																						{
;;;461    																									//报锁打开
;;;462    																							    if((wbuf[23]==0x01)||(wbuf[23]==0x02)||(wbuf[23]==0x03)||((wbuf[23]==0x05)))
;;;463    																									{
;;;464    																													lock.item.stu|=0x01;
;;;465    																										      IT1_Lock_DataLoad(0,0x01,lock.item.stu); 
;;;466    																										      //如果有推送																													//如果有推送
;;;467    																													//if((Dev.mode&0x02)!=0x00)
;;;468    																										      if((lock.item.safe!=0)||((lock.item.stu&0x02)!=0x00))
;;;469    																													{
;;;470    																														   DlyEvent_handle(0,0x03,0x05,1000);
;;;471    																													}
;;;472    																									}
;;;473    																									//报锁关闭
;;;474    																									else if(wbuf[23]==0x00)
;;;475    																									{
;;;476    																													lock.item.stu&=0xfe;
;;;477    																										      IT1_Lock_DataLoad(0,0x01,lock.item.stu); 
;;;478    																										      //如果有推送																													//如果有推送
;;;479    																													//if((Dev.mode&0x02)!=0x00)
;;;480    																										      if((lock.item.safe!=0)||((lock.item.stu&0x02)!=0x00))
;;;481    																													{
;;;482    																														   tt=0;tt=(3<<5);
;;;483    																														   DlyEvent_handle(0,0x03,0x06,1000);
;;;484    																													}
;;;485    																									}
;;;486    																									//其他不处理
;;;487    																									else
;;;488    																									{
;;;489    																										
;;;490    																									}
;;;491    																						}
;;;492    																				}
;;;493    																		}
;;;494    															}
;;;495    															//应答处理
;;;496    															else if(wbuf[1]==0x00)
;;;497    															{
;;;498    																		//查看地址是否已经保存
;;;499    																		pws=GetQueue_OutQ(&WirelessSend_Queue,&index);
;;;500    																		if(pws==NULL)return;
;;;501    																		if((pws->ackwait!=0)&&(pws->buf[6]==wbuf[6])&&(pws->buf[7]==wbuf[7]) \
;;;502    																			&&(pws->buf[8]==wbuf[8])&&(pws->buf[9]==wbuf[9]))
;;;503    																		{
;;;504    																					for(i=0;i<pws->cnt;i++)pws->buf[i]=0x00;
;;;505    																					pws->cnt=0;
;;;506    																					pws->flag=0;
;;;507    																					pws->ackwait=0;
;;;508    																					DeQueueBuf(&WirelessSend_Queue,index);						
;;;509    																		}
;;;510    															}
;;;511    														}
;;;512    													}
;;;513    				}
;;;514    	      //以上处理正常模式下，收到无线帧
;;;515    	      //====================================================================================================
;;;516    	      //====================================================================================================
;;;517    	      //转发器处于设置状态
;;;518    	      else if(Dev.stu==DEV_SETUP)
;;;519    	      {
;;;520    	      	  //学习遥控器
;;;521    	      		if(Dev.learn_time>0)
;;;522    	      		{
;;;523    								if((Dev.type&0xf000)==0xb000)
;;;524    								{
;;;525    												if((wbuf[1]&0x80)==0x80)
;;;526    												//if((wbuf[1]<0x0a)&&(wbuf[1]!=0x00))	//小于0x0a且不为0时为明码
;;;527    												{
;;;528    														if(((wbuf[1]==0x11)||(wbuf[1]==0x12))&&(wbuf[2]==0xff)&&(wbuf[3]==0xff)&&(wbuf[4]==0xff)&&(wbuf[5]==0xff))
;;;529    														{
;;;530    																	//==========================================================================
;;;531    																	#ifdef USE_3MATCH
;;;532    																	if(step==0)
;;;533    																	{
;;;534    																				index=Exchangebuf.addr;
;;;535    																				Exchangebuf.wl_addr[0]=wbuf[6];
;;;536    																				Exchangebuf.wl_addr[1]=wbuf[7];
;;;537    																				Exchangebuf.wl_addr[2]=wbuf[8];
;;;538    																				Exchangebuf.channel   =wbuf[9];	
;;;539    																				step++;
;;;540    																				Wireless_Recv_Disable(&wbuf[0],100);
;;;541    																	}
;;;542    																	else
;;;543    																	{
;;;544    																				if((Exchangebuf.wl_addr[0]==wbuf[6])&&(Exchangebuf.wl_addr[1]==wbuf[7]) \
;;;545    																				&&(Exchangebuf.wl_addr[2]==wbuf[8])&&(Exchangebuf.channel  ==wbuf[9]))
;;;546    																				{
;;;547    																						step++;
;;;548    																						Wireless_Recv_Disable(&wbuf[0],100);			//
;;;549    																						if(step>=3)
;;;550    																						{
;;;551    																									Wireless_Learn_Finish();
;;;552    																									step=0;
;;;553    																						}
;;;554    																				}
;;;555    																	}									
;;;556    																	//===========================================================================
;;;557    																	#else   
;;;558    																	Wireless_Learn_Finish();
;;;559    																	#endif
;;;560    																	
;;;561    															}
;;;562    												}
;;;563    												//============================================================================================
;;;564    												//以下需要解密
;;;565    												else
;;;566    												{
;;;567    															//先解密数据
;;;568    															for(i=0;i<4;i++)buf[i]=wbuf[10+i];
;;;569    															ComposePacketFromDS28E02(&wbuf[6],&buf[0],4,0);//源地址为前3个字节
;;;570    															for(i=0;i<4;i++)wbuf[10+i]=buf[i];
;;;571    													
;;;572    															//wbuf[WL_FT]=wbuf[WL_FT]&0x7f;
;;;573    															if(wbuf[WL_FT]==0x0b)															//对码帧
;;;574    															{
;;;575    																	//没有带类型上来，为通用遥控器,有设置键
;;;576    																	//if((wbuf[WL_CMD]==0xff)&&(wbuf[WL_DAT]==0xff))
;;;577    																	if(wbuf[WL_CMD]==0xff)
;;;578    																	{
;;;579    																				Wireless_Learn_Finish();
;;;580    																	}
;;;581    																	//带类型上来，一般为传感器
;;;582    																	else
;;;583    																	{
;;;584    																				type=IT1_RS4852Wireless(wbuf[WL_CMD],wbuf[WL_DAT]);
;;;585    																				if(type==Ex_Table.Exchange[index].type)				//类型对													 
;;;586    																				{
;;;587    																						Wireless_Learn_Finish();
;;;588    																				}
;;;589    																		}
;;;590    															}
;;;591    															//不指定类型，设备没有设置键
;;;592    															else if((wbuf[1]==0x10)&&(wbuf[2]==0xff)&&(wbuf[3]==0xff)&&(wbuf[4]==0xff)&&(wbuf[5]==0xff))
;;;593    															{
;;;594    																	if(step==0)
;;;595    																	{
;;;596    																				index=Exchangebuf.addr;
;;;597    																				Exchangebuf.wl_addr[0]=wbuf[6];
;;;598    																				Exchangebuf.wl_addr[1]=wbuf[7];
;;;599    																				Exchangebuf.wl_addr[2]=wbuf[8];
;;;600    																				Exchangebuf.channel   =wbuf[9];	
;;;601    																				step++;
;;;602    																				Wireless_Recv_Disable(&wbuf[0],200);
;;;603    																	}
;;;604    																	else
;;;605    																	{
;;;606    																				if((Exchangebuf.wl_addr[0]==wbuf[6])&&(Exchangebuf.wl_addr[1]==wbuf[7]) \
;;;607    																				&&(Exchangebuf.wl_addr[2]==wbuf[8])&&(Exchangebuf.channel  ==wbuf[9]))
;;;608    																				{
;;;609    																						step++;
;;;610    																						Wireless_Recv_Disable(&wbuf[0],200);			//
;;;611    																						if(step>=3)
;;;612    																						{
;;;613    																								Wireless_Learn_Finish();
;;;614    																								step=0;
;;;615    																						}
;;;616    																				}
;;;617    																	}									
;;;618    															}
;;;619    												}
;;;620    									}
;;;621    									//==========================================================================================
;;;622    									//这里处理锁转发器
;;;623    									else if((Dev.type&0xf000)==0x3000)
;;;624    									{
;;;625    												//先解密数据
;;;626    										    #ifdef USE_LOCK_BY_DS28E11   //锁使用加密
;;;627    												for(i=0;i<4;i++)buf[i]=wbuf[10+i];
;;;628    												ComposePacketFromDS28E02(&wbuf[6],&buf[0],4,0);//源地址为前3个字节
;;;629    												for(i=0;i<4;i++)wbuf[10+i]=buf[i];
;;;630    										    #endif
;;;631    										
;;;632    												if(wbuf[WL_FT]==0x0b)														
;;;633    												{
;;;634    														if(wbuf[WL_CMD]==0xf0)
;;;635    														{
;;;636    															    lock.index=0;
;;;637    																	WlLock_Learn_Finish();
;;;638    														}
;;;639    												}
;;;640    								
;;;641    										
;;;642    									}
;;;643    					   }
;;;644    							//==============================================================================================
;;;645    							//退出设置状态
;;;646    							else
;;;647    							{
;;;648    										Dev.stu=DEV_NORMAL;
;;;649    										//#ifdef USE_3MATCH
;;;650    										step=0;	
;;;651    										//#endif
;;;652    										Exchangebuf.addr=0xff;
;;;653    										Exchangebuf.type=0xff;
;;;654    										Exchangebuf.wl_addr[0]=0xff;
;;;655    										Exchangebuf.wl_addr[1]=0xff;
;;;656    										Exchangebuf.wl_addr[2]=0xff;
;;;657    										Exchangebuf.channel   =0xff;
;;;658    								
;;;659    										Led_set(1,25,25,1,2);	
;;;660    							}
;;;661    	      }
;;;662    				//以上转发器处于对码状态
;;;663    				else
;;;664    				{
;;;665    							//设备处于未注册状态，不运行
;;;666    				}
;;;667    	  //=======================================================================================
;;;668    	}
;;;669    	if(CC1101_ResetTime>300)
;;;670    	{
;;;671    			CC1101_ResetTime=0;
;;;672    		  #ifdef USE_A7139
;;;673    		  bsp_InitRF(1);	
;;;674    		  #else
;;;675    			bsp_InitCC1101();
;;;676    		  #endif
;;;677    	}
;;;678      //=============================================================================================	
;;;679    }
000084  b00d              ADD      sp,sp,#0x34
000086  e8bd8ff0          POP      {r4-r11,pc}
                  |L9.138|
00008a  2700              MOVS     r7,#0                 ;159
00008c  2400              MOVS     r4,#0                 ;160
00008e  e008              B        |L9.162|
                  |L9.144|
000090  1ca0              ADDS     r0,r4,#2              ;160
000092  49de              LDR      r1,|L9.1036|
000094  5c08              LDRB     r0,[r1,r0]            ;160
000096  28ff              CMP      r0,#0xff              ;160
000098  d001              BEQ      |L9.158|
00009a  1c78              ADDS     r0,r7,#1              ;160
00009c  b2c7              UXTB     r7,r0                 ;160
                  |L9.158|
00009e  1c60              ADDS     r0,r4,#1              ;160
0000a0  b2c4              UXTB     r4,r0                 ;160
                  |L9.162|
0000a2  2c04              CMP      r4,#4                 ;160
0000a4  dbf4              BLT      |L9.144|
0000a6  b17f              CBZ      r7,|L9.200|
0000a8  2700              MOVS     r7,#0                 ;163
0000aa  2400              MOVS     r4,#0                 ;164
0000ac  e00a              B        |L9.196|
                  |L9.174|
0000ae  1ca0              ADDS     r0,r4,#2              ;164
0000b0  49d6              LDR      r1,|L9.1036|
0000b2  5c09              LDRB     r1,[r1,r0]            ;164
0000b4  48d6              LDR      r0,|L9.1040|
0000b6  5d00              LDRB     r0,[r0,r4]            ;164
0000b8  4281              CMP      r1,r0                 ;164
0000ba  d001              BEQ      |L9.192|
0000bc  1c78              ADDS     r0,r7,#1              ;164
0000be  b2c7              UXTB     r7,r0                 ;164
                  |L9.192|
0000c0  1c60              ADDS     r0,r4,#1              ;164
0000c2  b2c4              UXTB     r4,r0                 ;164
                  |L9.196|
0000c4  2c04              CMP      r4,#4                 ;164
0000c6  dbf2              BLT      |L9.174|
                  |L9.200|
0000c8  b107              CBZ      r7,|L9.204|
0000ca  e7db              B        |L9.132|
                  |L9.204|
0000cc  48d1              LDR      r0,|L9.1044|
0000ce  8880              LDRH     r0,[r0,#4]            ;169  ; Dev
0000d0  f4004070          AND      r0,r0,#0xf000         ;169
0000d4  f5b04f30          CMP      r0,#0xb000            ;169
0000d8  d105              BNE      |L9.230|
0000da  a90a              ADD      r1,sp,#0x28           ;171
0000dc  48cb              LDR      r0,|L9.1036|
0000de  1d80              ADDS     r0,r0,#6              ;171
0000e0  f7fffffe          BL       Check_Wireless_Addr
0000e4  e00b              B        |L9.254|
                  |L9.230|
0000e6  48cb              LDR      r0,|L9.1044|
0000e8  8880              LDRH     r0,[r0,#4]            ;173  ; Dev
0000ea  f4004070          AND      r0,r0,#0xf000         ;173
0000ee  f5b05f40          CMP      r0,#0x3000            ;173
0000f2  d104              BNE      |L9.254|
0000f4  a90a              ADD      r1,sp,#0x28           ;175
0000f6  48c5              LDR      r0,|L9.1036|
0000f8  1d80              ADDS     r0,r0,#6              ;175
0000fa  f7fffffe          BL       Check_WlLock_Addr
                  |L9.254|
0000fe  48c3              LDR      r0,|L9.1036|
000100  f7fffffe          BL       Wireless_Recv_IsRun
000104  4607              MOV      r7,r0                 ;179
000106  2ffb              CMP      r7,#0xfb              ;180
000108  d000              BEQ      |L9.268|
00010a  e7bb              B        |L9.132|
                  |L9.268|
00010c  f89d0028          LDRB     r0,[sp,#0x28]         ;182
000110  28ff              CMP      r0,#0xff              ;182
000112  d007              BEQ      |L9.292|
000114  2002              MOVS     r0,#2                 ;182
000116  2301              MOVS     r3,#1                 ;182
000118  2219              MOVS     r2,#0x19              ;182
00011a  4611              MOV      r1,r2                 ;182
00011c  9000              STR      r0,[sp,#0]            ;182
00011e  4618              MOV      r0,r3                 ;182
000120  f7fffffe          BL       Led_set
                  |L9.292|
000124  48bb              LDR      r0,|L9.1044|
000126  7980              LDRB     r0,[r0,#6]            ;185  ; Dev
000128  2802              CMP      r0,#2                 ;185
00012a  d17d              BNE      |L9.552|
00012c  f89d0028          LDRB     r0,[sp,#0x28]         ;187
000130  28ff              CMP      r0,#0xff              ;187
000132  e000              B        |L9.310|
                  |L9.308|
000134  e031              B        |L9.410|
                  |L9.310|
000136  d100              BNE      |L9.314|
000138  e7a4              B        |L9.132|
                  |L9.314|
00013a  48b4              LDR      r0,|L9.1036|
00013c  7840              LDRB     r0,[r0,#1]            ;189  ; wbuf
00013e  f0000080          AND      r0,r0,#0x80           ;189
000142  2880              CMP      r0,#0x80              ;189
000144  d171              BNE      |L9.554|
000146  2196              MOVS     r1,#0x96              ;191
000148  48b0              LDR      r0,|L9.1036|
00014a  f7fffffe          BL       Wireless_Recv_Disable
00014e  48af              LDR      r0,|L9.1036|
000150  7840              LDRB     r0,[r0,#1]            ;194  ; wbuf
000152  2811              CMP      r0,#0x11              ;194
000154  d16a              BNE      |L9.556|
000156  48af              LDR      r0,|L9.1044|
000158  7800              LDRB     r0,[r0,#0]            ;196  ; Dev
00015a  2800              CMP      r0,#0                 ;196
00015c  d11d              BNE      |L9.410|
00015e  f89d0028          LDRB     r0,[sp,#0x28]         ;199
000162  ebc001c0          RSB      r1,r0,r0,LSL #3       ;199
000166  48aa              LDR      r0,|L9.1040|
000168  3035              ADDS     r0,r0,#0x35           ;199
00016a  f8100011          LDRB     r0,[r0,r1,LSL #1]     ;199
00016e  28fa              CMP      r0,#0xfa              ;199
000170  d009              BEQ      |L9.390|
000172  f89d0028          LDRB     r0,[sp,#0x28]         ;199
000176  ebc001c0          RSB      r1,r0,r0,LSL #3       ;199
00017a  48a5              LDR      r0,|L9.1040|
00017c  3035              ADDS     r0,r0,#0x35           ;199
00017e  f8100011          LDRB     r0,[r0,r1,LSL #1]     ;199
000182  28fb              CMP      r0,#0xfb              ;199
000184  d10a              BNE      |L9.412|
                  |L9.390|
000186  48a1              LDR      r0,|L9.1036|
000188  f890a00c          LDRB     r10,[r0,#0xc]         ;201  ; wbuf
00018c  7b46              LDRB     r6,[r0,#0xd]          ;202  ; wbuf
00018e  4632              MOV      r2,r6                 ;204
000190  4651              MOV      r1,r10                ;204
000192  f89d0028          LDRB     r0,[sp,#0x28]         ;204
000196  f7fffffe          BL       IT1_Key_DataLoad
                  |L9.410|
00019a  e234              B        |L9.1542|
                  |L9.412|
00019c  f89d0028          LDRB     r0,[sp,#0x28]         ;206
0001a0  ebc001c0          RSB      r1,r0,r0,LSL #3       ;206
0001a4  489a              LDR      r0,|L9.1040|
0001a6  3035              ADDS     r0,r0,#0x35           ;206
0001a8  f8100011          LDRB     r0,[r0,r1,LSL #1]     ;206
0001ac  28e2              CMP      r0,#0xe2              ;206
0001ae  d110              BNE      |L9.466|
0001b0  2002              MOVS     r0,#2                 ;208
0001b2  f88d0018          STRB     r0,[sp,#0x18]         ;208
0001b6  4895              LDR      r0,|L9.1036|
0001b8  7b00              LDRB     r0,[r0,#0xc]          ;209  ; wbuf
0001ba  f88d0019          STRB     r0,[sp,#0x19]         ;209
0001be  4893              LDR      r0,|L9.1036|
0001c0  7b40              LDRB     r0,[r0,#0xd]          ;210  ; wbuf
0001c2  f88d001a          STRB     r0,[sp,#0x1a]         ;210
0001c6  a906              ADD      r1,sp,#0x18           ;211
0001c8  f89d0028          LDRB     r0,[sp,#0x28]         ;211
0001cc  f7fffffe          BL       IT1_Sensor_DataLoad
0001d0  e7e3              B        |L9.410|
                  |L9.466|
0001d2  f89d0028          LDRB     r0,[sp,#0x28]         ;213
0001d6  ebc001c0          RSB      r1,r0,r0,LSL #3       ;213
0001da  488d              LDR      r0,|L9.1040|
0001dc  3035              ADDS     r0,r0,#0x35           ;213
0001de  f8100011          LDRB     r0,[r0,r1,LSL #1]     ;213
0001e2  28e4              CMP      r0,#0xe4              ;213
0001e4  d110              BNE      |L9.520|
0001e6  2002              MOVS     r0,#2                 ;215
0001e8  f88d0018          STRB     r0,[sp,#0x18]         ;215
0001ec  4887              LDR      r0,|L9.1036|
0001ee  7a80              LDRB     r0,[r0,#0xa]          ;216  ; wbuf
0001f0  f88d0019          STRB     r0,[sp,#0x19]         ;216
0001f4  4885              LDR      r0,|L9.1036|
0001f6  7ac0              LDRB     r0,[r0,#0xb]          ;217  ; wbuf
0001f8  f88d001a          STRB     r0,[sp,#0x1a]         ;217
0001fc  a906              ADD      r1,sp,#0x18           ;218
0001fe  f89d0028          LDRB     r0,[sp,#0x28]         ;218
000202  f7fffffe          BL       IT1_Sensor_DataLoad
                  |L9.518|
000206  e7c8              B        |L9.410|
                  |L9.520|
000208  f89d0028          LDRB     r0,[sp,#0x28]         ;220
00020c  ebc001c0          RSB      r1,r0,r0,LSL #3       ;220
000210  487f              LDR      r0,|L9.1040|
000212  3035              ADDS     r0,r0,#0x35           ;220
000214  f8100011          LDRB     r0,[r0,r1,LSL #1]     ;220
000218  28f8              CMP      r0,#0xf8              ;220
00021a  d00d              BEQ      |L9.568|
00021c  f89d0028          LDRB     r0,[sp,#0x28]         ;220
000220  ebc001c0          RSB      r1,r0,r0,LSL #3       ;220
000224  487a              LDR      r0,|L9.1040|
000226  e002              B        |L9.558|
                  |L9.552|
000228  e320              B        |L9.2156|
                  |L9.554|
00022a  e0f9              B        |L9.1056|
                  |L9.556|
00022c  e02b              B        |L9.646|
                  |L9.558|
00022e  3035              ADDS     r0,r0,#0x35           ;220
000230  f8100011          LDRB     r0,[r0,r1,LSL #1]     ;220
000234  28f9              CMP      r0,#0xf9              ;220
000236  d10d              BNE      |L9.596|
                  |L9.568|
000238  4874              LDR      r0,|L9.1036|
00023a  7b00              LDRB     r0,[r0,#0xc]          ;222  ; wbuf
00023c  1c40              ADDS     r0,r0,#1              ;222
00023e  f0000aff          AND      r10,r0,#0xff          ;222
000242  4872              LDR      r0,|L9.1036|
000244  7b46              LDRB     r6,[r0,#0xd]          ;223  ; wbuf
000246  4632              MOV      r2,r6                 ;224
000248  4651              MOV      r1,r10                ;224
00024a  f89d0028          LDRB     r0,[sp,#0x28]         ;224
00024e  f7fffffe          BL       IT1_Key_DataLoad
000252  e7a2              B        |L9.410|
                  |L9.596|
000254  486d              LDR      r0,|L9.1036|
000256  7b00              LDRB     r0,[r0,#0xc]          ;228  ; wbuf
000258  9008              STR      r0,[sp,#0x20]         ;228
00025a  2400              MOVS     r4,#0                 ;229
00025c  e007              B        |L9.622|
                  |L9.606|
00025e  f104000c          ADD      r0,r4,#0xc            ;229
000262  496a              LDR      r1,|L9.1036|
000264  5c08              LDRB     r0,[r1,r0]            ;229
000266  a906              ADD      r1,sp,#0x18           ;229
000268  5508              STRB     r0,[r1,r4]            ;229
00026a  1c60              ADDS     r0,r4,#1              ;229
00026c  b2c4              UXTB     r4,r0                 ;229
                  |L9.622|
00026e  f89d0020          LDRB     r0,[sp,#0x20]         ;229
000272  4284              CMP      r4,r0                 ;229
000274  dbf3              BLT      |L9.606|
000276  aa06              ADD      r2,sp,#0x18           ;230
000278  f89d1020          LDRB     r1,[sp,#0x20]         ;230
00027c  f89d0028          LDRB     r0,[sp,#0x28]         ;230
000280  f7fffffe          BL       IT1_RS485_StuLoad
000284  e3f0              B        |L9.2664|
                  |L9.646|
000286  4861              LDR      r0,|L9.1036|
000288  7840              LDRB     r0,[r0,#1]            ;236  ; wbuf
00028a  2812              CMP      r0,#0x12              ;236
00028c  d134              BNE      |L9.760|
00028e  485f              LDR      r0,|L9.1036|
000290  7ac0              LDRB     r0,[r0,#0xb]          ;238  ; wbuf
000292  495e              LDR      r1,|L9.1036|
000294  7a89              LDRB     r1,[r1,#0xa]          ;238  ; wbuf
000296  eb002001          ADD      r0,r0,r1,LSL #8       ;238
00029a  fa1ff880          UXTH     r8,r0                 ;238
00029e  485c              LDR      r0,|L9.1040|
0002a0  3015              ADDS     r0,r0,#0x15           ;239
0002a2  f89d1028          LDRB     r1,[sp,#0x28]         ;239
0002a6  f8300011          LDRH     r0,[r0,r1,LSL #1]     ;239
0002aa  4540              CMP      r0,r8                 ;239
0002ac  d100              BNE      |L9.688|
                  |L9.686|
0002ae  e6e9              B        |L9.132|
                  |L9.688|
0002b0  4857              LDR      r0,|L9.1040|
0002b2  3015              ADDS     r0,r0,#0x15           ;240
0002b4  f89d1028          LDRB     r1,[sp,#0x28]         ;240
0002b8  f8208011          STRH     r8,[r0,r1,LSL #1]     ;240
0002bc  4853              LDR      r0,|L9.1036|
0002be  f890a00c          LDRB     r10,[r0,#0xc]         ;241  ; wbuf
0002c2  7b46              LDRB     r6,[r0,#0xd]          ;242  ; wbuf
0002c4  2200              MOVS     r2,#0                 ;243
0002c6  4651              MOV      r1,r10                ;243
0002c8  f89d0028          LDRB     r0,[sp,#0x28]         ;243
0002cc  f7fffffe          BL       IT1_Turn_DataLoad
0002d0  f04f0900          MOV      r9,#0                 ;244
0002d4  f44f7980          MOV      r9,#0x100             ;245
0002d8  44d1              ADD      r9,r9,r10             ;246
0002da  2e00              CMP      r6,#0                 ;247
0002dc  dd93              BLE      |L9.518|
0002de  1e70              SUBS     r0,r6,#1              ;247
0002e0  b2c6              UXTB     r6,r0                 ;247
0002e2  e006              B        |L9.754|
                  |L9.740|
0002e4  f89d1028          LDRB     r1,[sp,#0x28]         ;247
0002e8  4648              MOV      r0,r9                 ;247
0002ea  f7fffffe          BL       bsp_PutMsg
0002ee  1e70              SUBS     r0,r6,#1              ;247
0002f0  b2c6              UXTB     r6,r0                 ;247
                  |L9.754|
0002f2  2e00              CMP      r6,#0                 ;247
0002f4  dcf6              BGT      |L9.740|
0002f6  e3b7              B        |L9.2664|
                  |L9.760|
0002f8  4844              LDR      r0,|L9.1036|
0002fa  7840              LDRB     r0,[r0,#1]            ;251  ; wbuf
0002fc  bb60              CBNZ     r0,|L9.856|
0002fe  4846              LDR      r0,|L9.1048|
000300  7880              LDRB     r0,[r0,#2]            ;251  ; Ir
000302  2801              CMP      r0,#1                 ;251
000304  d128              BNE      |L9.856|
000306  4841              LDR      r0,|L9.1036|
000308  7a80              LDRB     r0,[r0,#0xa]          ;251  ; wbuf
00030a  f000000f          AND      r0,r0,#0xf            ;251
00030e  4942              LDR      r1,|L9.1048|
000310  7a09              LDRB     r1,[r1,#8]            ;251  ; Ir
000312  4288              CMP      r0,r1                 ;251
000314  d120              BNE      |L9.856|
000316  a90a              ADD      r1,sp,#0x28           ;253
000318  4840              LDR      r0,|L9.1052|
00031a  f7fffffe          BL       GetQueue_OutQ
00031e  4605              MOV      r5,r0                 ;253
000320  b905              CBNZ     r5,|L9.804|
000322  e6af              B        |L9.132|
                  |L9.804|
000324  2400              MOVS     r4,#0                 ;258
000326  e003              B        |L9.816|
                  |L9.808|
000328  2000              MOVS     r0,#0                 ;258
00032a  5528              STRB     r0,[r5,r4]            ;258
00032c  1c60              ADDS     r0,r4,#1              ;258
00032e  b2c4              UXTB     r4,r0                 ;258
                  |L9.816|
000330  f89500c8          LDRB     r0,[r5,#0xc8]         ;258
000334  42a0              CMP      r0,r4                 ;258
000336  dcf7              BGT      |L9.808|
000338  2000              MOVS     r0,#0                 ;259
00033a  f8050fc8          STRB     r0,[r5,#0xc8]!        ;259
00033e  7068              STRB     r0,[r5,#1]            ;260
000340  7168              STRB     r0,[r5,#5]            ;261
000342  f1a505c8          SUB      r5,r5,#0xc8           ;261
000346  f89d1028          LDRB     r1,[sp,#0x28]         ;263
00034a  4834              LDR      r0,|L9.1052|
00034c  f7fffffe          BL       DeQueueBuf
000350  2000              MOVS     r0,#0                 ;265
000352  4931              LDR      r1,|L9.1048|
000354  7088              STRB     r0,[r1,#2]            ;265
                  |L9.854|
000356  e387              B        |L9.2664|
                  |L9.856|
000358  482c              LDR      r0,|L9.1036|
00035a  7840              LDRB     r0,[r0,#1]            ;269  ; wbuf
00035c  2842              CMP      r0,#0x42              ;269
00035e  d123              BNE      |L9.936|
000360  482d              LDR      r0,|L9.1048|
000362  7840              LDRB     r0,[r0,#1]            ;269  ; Ir
000364  bb00              CBNZ     r0,|L9.936|
000366  2164              MOVS     r1,#0x64              ;272
000368  4828              LDR      r0,|L9.1036|
00036a  f7fffffe          BL       Wireless_Recv_Disable
00036e  482a              LDR      r0,|L9.1048|
000370  f89000db          LDRB     r0,[r0,#0xdb]         ;275  ; Ir
000374  4925              LDR      r1,|L9.1036|
000376  7a89              LDRB     r1,[r1,#0xa]          ;275  ; wbuf
000378  4288              CMP      r0,r1                 ;275
00037a  d111              BNE      |L9.928|
00037c  4826              LDR      r0,|L9.1048|
00037e  f89000dc          LDRB     r0,[r0,#0xdc]         ;275  ; Ir
000382  4922              LDR      r1,|L9.1036|
000384  7ac9              LDRB     r1,[r1,#0xb]          ;275  ; wbuf
000386  4288              CMP      r0,r1                 ;275
000388  d10a              BNE      |L9.928|
00038a  20fb              MOVS     r0,#0xfb              ;277
00038c  f7fffffe          BL       IT1_IrSetup_Report
000390  4821              LDR      r0,|L9.1048|
000392  7a82              LDRB     r2,[r0,#0xa]          ;278  ; Ir
000394  7a41              LDRB     r1,[r0,#9]            ;278  ; Ir
000396  f89d0028          LDRB     r0,[sp,#0x28]         ;278
00039a  f7fffffe          BL       Ir_Config_Add
00039e  e363              B        |L9.2664|
                  |L9.928|
0003a0  20fc              MOVS     r0,#0xfc              ;282
0003a2  f7fffffe          BL       IT1_IrSetup_Report
0003a6  e35f              B        |L9.2664|
                  |L9.936|
0003a8  4818              LDR      r0,|L9.1036|
0003aa  7840              LDRB     r0,[r0,#1]            ;287  ; wbuf
0003ac  b9c8              CBNZ     r0,|L9.994|
0003ae  4817              LDR      r0,|L9.1036|
0003b0  7a80              LDRB     r0,[r0,#0xa]          ;287  ; wbuf
0003b2  4919              LDR      r1,|L9.1048|
0003b4  7a09              LDRB     r1,[r1,#8]            ;287  ; Ir
0003b6  4288              CMP      r0,r1                 ;287
0003b8  d113              BNE      |L9.994|
0003ba  4814              LDR      r0,|L9.1036|
0003bc  7b00              LDRB     r0,[r0,#0xc]          ;287  ; wbuf
0003be  2844              CMP      r0,#0x44              ;287
0003c0  d10f              BNE      |L9.994|
0003c2  21e6              MOVS     r1,#0xe6              ;289
0003c4  4811              LDR      r0,|L9.1036|
0003c6  f7fffffe          BL       Wireless_Recv_Disable
0003ca  f89d0028          LDRB     r0,[sp,#0x28]         ;290
0003ce  f7fffffe          BL       IT1_IrDel_Report
0003d2  4811              LDR      r0,|L9.1048|
0003d4  7a82              LDRB     r2,[r0,#0xa]          ;291  ; Ir
0003d6  7a41              LDRB     r1,[r0,#9]            ;291  ; Ir
0003d8  f89d0028          LDRB     r0,[sp,#0x28]         ;291
0003dc  f7fffffe          BL       Ir_Config_Del
                  |L9.992|
0003e0  e342              B        |L9.2664|
                  |L9.994|
0003e2  480a              LDR      r0,|L9.1036|
0003e4  7840              LDRB     r0,[r0,#1]            ;295  ; wbuf
0003e6  28e0              CMP      r0,#0xe0              ;295
0003e8  d003              BEQ      |L9.1010|
0003ea  4808              LDR      r0,|L9.1036|
0003ec  7840              LDRB     r0,[r0,#1]            ;295  ; wbuf
0003ee  28e1              CMP      r0,#0xe1              ;295
0003f0  d1b1              BNE      |L9.854|
                  |L9.1010|
0003f2  4806              LDR      r0,|L9.1036|
0003f4  7841              LDRB     r1,[r0,#1]            ;297  ; wbuf
0003f6  f100020a          ADD      r2,r0,#0xa            ;297
0003fa  f89d0028          LDRB     r0,[sp,#0x28]         ;297
0003fe  f7fffffe          BL       Pannel_Table_Refresh
                  |L9.1026|
000402  e331              B        |L9.2664|
                  |L9.1028|
                          DCD      dis_tim
                  |L9.1032|
                          DCD      CC1101_ResetTime
                  |L9.1036|
                          DCD      wbuf
                  |L9.1040|
                          DCD      Ex_Table+0x1
                  |L9.1044|
                          DCD      ||Dev||
                  |L9.1048|
                          DCD      ||Ir||
                  |L9.1052|
                          DCD      WirelessSend_Queue
                  |L9.1056|
000420  21fa              MOVS     r1,#0xfa              ;305
000422  48fe              LDR      r0,|L9.2076|
000424  f7fffffe          BL       Wireless_Recv_Disable
000428  48fd              LDR      r0,|L9.2080|
00042a  8880              LDRH     r0,[r0,#4]            ;307  ; Dev
00042c  f4004070          AND      r0,r0,#0xf000         ;307
000430  f5b04f30          CMP      r0,#0xb000            ;307
000434  d15e              BNE      |L9.1268|
000436  48f9              LDR      r0,|L9.2076|
000438  7840              LDRB     r0,[r0,#1]            ;310  ; wbuf
00043a  b1a0              CBZ      r0,|L9.1126|
00043c  f89d0020          LDRB     r0,[sp,#0x20]         ;312
000440  380c              SUBS     r0,r0,#0xc            ;312
000442  b2c0              UXTB     r0,r0                 ;312
000444  9005              STR      r0,[sp,#0x14]         ;312
000446  f89d2028          LDRB     r2,[sp,#0x28]         ;313
00044a  48f4              LDR      r0,|L9.2076|
00044c  300a              ADDS     r0,r0,#0xa            ;313
00044e  9905              LDR      r1,[sp,#0x14]         ;313
000450  f7fffffe          BL       ComposePacket
000454  f89d1028          LDRB     r1,[sp,#0x28]         ;315
000458  48f0              LDR      r0,|L9.2076|
00045a  300a              ADDS     r0,r0,#0xa            ;315
00045c  f7fffffe          BL       CompareSync
000460  28fb              CMP      r0,#0xfb              ;315
000462  d000              BEQ      |L9.1126|
000464  e60e              B        |L9.132|
                  |L9.1126|
000466  48ed              LDR      r0,|L9.2076|
000468  7840              LDRB     r0,[r0,#1]            ;322  ; wbuf
00046a  2812              CMP      r0,#0x12              ;322
00046c  d130              BNE      |L9.1232|
00046e  48eb              LDR      r0,|L9.2076|
000470  7ac0              LDRB     r0,[r0,#0xb]          ;324  ; wbuf
000472  49ea              LDR      r1,|L9.2076|
000474  7a89              LDRB     r1,[r1,#0xa]          ;324  ; wbuf
000476  eb002001          ADD      r0,r0,r1,LSL #8       ;324
00047a  fa1ff880          UXTH     r8,r0                 ;324
00047e  48e9              LDR      r0,|L9.2084|
000480  f89d1028          LDRB     r1,[sp,#0x28]         ;325
000484  f8300011          LDRH     r0,[r0,r1,LSL #1]     ;325
000488  4540              CMP      r0,r8                 ;325
00048a  d100              BNE      |L9.1166|
00048c  e5fa              B        |L9.132|
                  |L9.1166|
00048e  48e5              LDR      r0,|L9.2084|
000490  f89d1028          LDRB     r1,[sp,#0x28]         ;326
000494  f8208011          STRH     r8,[r0,r1,LSL #1]     ;326
000498  48e0              LDR      r0,|L9.2076|
00049a  f890a00c          LDRB     r10,[r0,#0xc]         ;327  ; wbuf
00049e  7b46              LDRB     r6,[r0,#0xd]          ;328  ; wbuf
0004a0  2200              MOVS     r2,#0                 ;329
0004a2  4651              MOV      r1,r10                ;329
0004a4  f89d0028          LDRB     r0,[sp,#0x28]         ;329
0004a8  f7fffffe          BL       IT1_Turn_DataLoad
0004ac  f04f0900          MOV      r9,#0                 ;338
0004b0  f44f7980          MOV      r9,#0x100             ;339
0004b4  f1090906          ADD      r9,r9,#6              ;340
0004b8  f1ba0f05          CMP      r10,#5                ;341
0004bc  d002              BEQ      |L9.1220|
0004be  f1ba0f06          CMP      r10,#6                ;341
0004c2  d18d              BNE      |L9.992|
                  |L9.1220|
0004c4  f89d1028          LDRB     r1,[sp,#0x28]         ;343
0004c8  4648              MOV      r0,r9                 ;343
0004ca  f7fffffe          BL       bsp_PutMsg
                  |L9.1230|
0004ce  e2cb              B        |L9.2664|
                  |L9.1232|
0004d0  48d2              LDR      r0,|L9.2076|
0004d2  7840              LDRB     r0,[r0,#1]            ;347  ; wbuf
0004d4  2811              CMP      r0,#0x11              ;347
0004d6  d194              BNE      |L9.1026|
0004d8  48d0              LDR      r0,|L9.2076|
0004da  7b00              LDRB     r0,[r0,#0xc]          ;349  ; wbuf
0004dc  1c40              ADDS     r0,r0,#1              ;349
0004de  f0000aff          AND      r10,r0,#0xff          ;349
0004e2  48ce              LDR      r0,|L9.2076|
0004e4  7b46              LDRB     r6,[r0,#0xd]          ;350  ; wbuf
0004e6  2201              MOVS     r2,#1                 ;351
0004e8  4651              MOV      r1,r10                ;351
0004ea  f89d0028          LDRB     r0,[sp,#0x28]         ;351
0004ee  f7fffffe          BL       IT1_Key_DataLoad
0004f2  e2b9              B        |L9.2664|
                  |L9.1268|
0004f4  48ca              LDR      r0,|L9.2080|
0004f6  8880              LDRH     r0,[r0,#4]            ;356  ; Dev
0004f8  f4004070          AND      r0,r0,#0xf000         ;356
0004fc  f5b05f40          CMP      r0,#0x3000            ;356
000500  d1e5              BNE      |L9.1230|
000502  48c6              LDR      r0,|L9.2076|
000504  7840              LDRB     r0,[r0,#1]            ;369  ; wbuf
000506  2831              CMP      r0,#0x31              ;369
000508  d17e              BNE      |L9.1544|
00050a  48c4              LDR      r0,|L9.2076|
00050c  7b40              LDRB     r0,[r0,#0xd]          ;372  ; wbuf
00050e  2803              CMP      r0,#3                 ;372
000510  d1dd              BNE      |L9.1230|
000512  48c2              LDR      r0,|L9.2076|
000514  7b80              LDRB     r0,[r0,#0xe]          ;372  ; wbuf
000516  2802              CMP      r0,#2                 ;372
000518  d1d9              BNE      |L9.1230|
00051a  48c0              LDR      r0,|L9.2076|
00051c  7d41              LDRB     r1,[r0,#0x15]         ;374  ; wbuf
00051e  7d80              LDRB     r0,[r0,#0x16]         ;374  ; wbuf
000520  eb012000          ADD      r0,r1,r0,LSL #8       ;374
000524  fa1ff980          UXTH     r9,r0                 ;374
000528  2400              MOVS     r4,#0                 ;375
00052a  e007              B        |L9.1340|
                  |L9.1324|
00052c  48be              LDR      r0,|L9.2088|
00052e  f8300014          LDRH     r0,[r0,r4,LSL #1]     ;377
000532  4548              CMP      r0,r9                 ;377
000534  d100              BNE      |L9.1336|
000536  e003              B        |L9.1344|
                  |L9.1336|
000538  1c60              ADDS     r0,r4,#1              ;375
00053a  b2c4              UXTB     r4,r0                 ;375
                  |L9.1340|
00053c  2c10              CMP      r4,#0x10              ;375
00053e  dbf5              BLT      |L9.1324|
                  |L9.1344|
000540  bf00              NOP                            ;377
000542  2c10              CMP      r4,#0x10              ;380
000544  da7e              BGE      |L9.1604|
000546  48b8              LDR      r0,|L9.2088|
000548  3824              SUBS     r0,r0,#0x24           ;382
00054a  7b00              LDRB     r0,[r0,#0xc]          ;382  ; lock
00054c  2800              CMP      r0,#0                 ;382
00054e  dd0a              BLE      |L9.1382|
000550  2000              MOVS     r0,#0                 ;384
000552  49b5              LDR      r1,|L9.2088|
000554  3924              SUBS     r1,r1,#0x24           ;384
000556  7308              STRB     r0,[r1,#0xc]          ;384
000558  1c61              ADDS     r1,r4,#1              ;386
00055a  b2c8              UXTB     r0,r1                 ;386
00055c  22bb              MOVS     r2,#0xbb              ;386
00055e  2102              MOVS     r1,#2                 ;386
000560  f7fffffe          BL       IT1_Lock_DataLoad
                  |L9.1380|
000564  e280              B        |L9.2664|
                  |L9.1382|
000566  48ad              LDR      r0,|L9.2076|
000568  7dc0              LDRB     r0,[r0,#0x17]         ;390  ; wbuf
00056a  2801              CMP      r0,#1                 ;390
00056c  d00b              BEQ      |L9.1414|
00056e  48ab              LDR      r0,|L9.2076|
000570  7dc0              LDRB     r0,[r0,#0x17]         ;390  ; wbuf
000572  2802              CMP      r0,#2                 ;390
000574  d007              BEQ      |L9.1414|
000576  48a9              LDR      r0,|L9.2076|
000578  7dc0              LDRB     r0,[r0,#0x17]         ;390  ; wbuf
00057a  2803              CMP      r0,#3                 ;390
00057c  d003              BEQ      |L9.1414|
00057e  48a7              LDR      r0,|L9.2076|
000580  7dc0              LDRB     r0,[r0,#0x17]         ;390  ; wbuf
000582  2805              CMP      r0,#5                 ;390
000584  d141              BNE      |L9.1546|
                  |L9.1414|
000586  48a8              LDR      r0,|L9.2088|
000588  3824              SUBS     r0,r0,#0x24           ;393
00058a  8c40              LDRH     r0,[r0,#0x22]         ;393
00058c  f0400101          ORR      r1,r0,#1              ;393
000590  48a5              LDR      r0,|L9.2088|
000592  3824              SUBS     r0,r0,#0x24           ;393
000594  8441              STRH     r1,[r0,#0x22]         ;393
000596  f8902022          LDRB     r2,[r0,#0x22]         ;394
00059a  2101              MOVS     r1,#1                 ;394
00059c  2000              MOVS     r0,#0                 ;394
00059e  f7fffffe          BL       IT1_Lock_DataLoad
0005a2  4620              MOV      r0,r4                 ;396
0005a4  17e1              ASRS     r1,r4,#31             ;396
0005a6  eb047151          ADD      r1,r4,r1,LSR #29      ;396
0005aa  f3c10bc7          UBFX     r11,r1,#3,#8          ;396
0005ae  17e1              ASRS     r1,r4,#31             ;397
0005b0  eb047151          ADD      r1,r4,r1,LSR #29      ;397
0005b4  10c9              ASRS     r1,r1,#3              ;397
0005b6  eba401c1          SUB      r1,r4,r1,LSL #3       ;397
0005ba  b2c9              UXTB     r1,r1                 ;397
0005bc  9103              STR      r1,[sp,#0xc]          ;397
0005be  489b              LDR      r0,|L9.2092|
0005c0  f810000b          LDRB     r0,[r0,r11]           ;398
0005c4  2201              MOVS     r2,#1                 ;398
0005c6  9903              LDR      r1,[sp,#0xc]          ;398
0005c8  408a              LSLS     r2,r2,r1              ;398
0005ca  4210              TST      r0,r2                 ;398
0005cc  d009              BEQ      |L9.1506|
0005ce  1c60              ADDS     r0,r4,#1              ;401
0005d0  b2c0              UXTB     r0,r0                 ;401
0005d2  9002              STR      r0,[sp,#8]            ;401
0005d4  f44f737a          MOV      r3,#0x3e8             ;402
0005d8  2201              MOVS     r2,#1                 ;402
0005da  2100              MOVS     r1,#0                 ;402
0005dc  9802              LDR      r0,[sp,#8]            ;402
0005de  f7fffffe          BL       DlyEvent_handle
                  |L9.1506|
0005e2  4891              LDR      r0,|L9.2088|
0005e4  3824              SUBS     r0,r0,#0x24           ;406
0005e6  7cc0              LDRB     r0,[r0,#0x13]         ;406
0005e8  b930              CBNZ     r0,|L9.1528|
0005ea  488f              LDR      r0,|L9.2088|
0005ec  3824              SUBS     r0,r0,#0x24           ;406
0005ee  f8900022          LDRB     r0,[r0,#0x22]         ;406
0005f2  f0100f02          TST      r0,#2                 ;406
0005f6  d0b5              BEQ      |L9.1380|
                  |L9.1528|
0005f8  f44f737a          MOV      r3,#0x3e8             ;408
0005fc  2205              MOVS     r2,#5                 ;408
0005fe  2103              MOVS     r1,#3                 ;408
000600  2000              MOVS     r0,#0                 ;408
000602  f7fffffe          BL       DlyEvent_handle
                  |L9.1542|
000606  e22f              B        |L9.2664|
                  |L9.1544|
000608  e0e7              B        |L9.2010|
                  |L9.1546|
00060a  4884              LDR      r0,|L9.2076|
00060c  7dc0              LDRB     r0,[r0,#0x17]         ;411  ; wbuf
00060e  2800              CMP      r0,#0                 ;411
000610  d1a8              BNE      |L9.1380|
000612  4885              LDR      r0,|L9.2088|
000614  3824              SUBS     r0,r0,#0x24           ;415
000616  f8900022          LDRB     r0,[r0,#0x22]         ;415
00061a  f00001fe          AND      r1,r0,#0xfe           ;415
00061e  4882              LDR      r0,|L9.2088|
000620  3824              SUBS     r0,r0,#0x24           ;415
000622  8441              STRH     r1,[r0,#0x22]         ;415
000624  f8902022          LDRB     r2,[r0,#0x22]         ;416
000628  2101              MOVS     r1,#1                 ;416
00062a  2000              MOVS     r0,#0                 ;416
00062c  f7fffffe          BL       IT1_Lock_DataLoad
000630  4620              MOV      r0,r4                 ;418
000632  17e1              ASRS     r1,r4,#31             ;418
000634  eb047151          ADD      r1,r4,r1,LSR #29      ;418
000638  f3c10bc7          UBFX     r11,r1,#3,#8          ;418
00063c  17e1              ASRS     r1,r4,#31             ;419
00063e  eb047151          ADD      r1,r4,r1,LSR #29      ;419
000642  e000              B        |L9.1606|
                  |L9.1604|
000644  e029              B        |L9.1690|
                  |L9.1606|
000646  10c9              ASRS     r1,r1,#3              ;419
000648  eba401c1          SUB      r1,r4,r1,LSL #3       ;419
00064c  b2c9              UXTB     r1,r1                 ;419
00064e  9103              STR      r1,[sp,#0xc]          ;419
000650  4876              LDR      r0,|L9.2092|
000652  f810000b          LDRB     r0,[r0,r11]           ;420
000656  2201              MOVS     r2,#1                 ;420
000658  9903              LDR      r1,[sp,#0xc]          ;420
00065a  408a              LSLS     r2,r2,r1              ;420
00065c  4210              TST      r0,r2                 ;420
00065e  d009              BEQ      |L9.1652|
000660  1c60              ADDS     r0,r4,#1              ;422
000662  b2c0              UXTB     r0,r0                 ;422
000664  9002              STR      r0,[sp,#8]            ;422
000666  f44f737a          MOV      r3,#0x3e8             ;423
00066a  2200              MOVS     r2,#0                 ;423
00066c  4611              MOV      r1,r2                 ;423
00066e  9802              LDR      r0,[sp,#8]            ;423
000670  f7fffffe          BL       DlyEvent_handle
                  |L9.1652|
000674  486c              LDR      r0,|L9.2088|
000676  3824              SUBS     r0,r0,#0x24           ;427
000678  7cc0              LDRB     r0,[r0,#0x13]         ;427
00067a  b930              CBNZ     r0,|L9.1674|
00067c  486a              LDR      r0,|L9.2088|
00067e  3824              SUBS     r0,r0,#0x24           ;427
000680  f8900022          LDRB     r0,[r0,#0x22]         ;427
000684  f0100f02          TST      r0,#2                 ;427
000688  d0bd              BEQ      |L9.1542|
                  |L9.1674|
00068a  f44f737a          MOV      r3,#0x3e8             ;429
00068e  2206              MOVS     r2,#6                 ;429
000690  2103              MOVS     r1,#3                 ;429
000692  2000              MOVS     r0,#0                 ;429
000694  f7fffffe          BL       DlyEvent_handle
                  |L9.1688|
000698  e1e6              B        |L9.2664|
                  |L9.1690|
00069a  4863              LDR      r0,|L9.2088|
00069c  3824              SUBS     r0,r0,#0x24           ;444
00069e  7b00              LDRB     r0,[r0,#0xc]          ;444  ; lock
0006a0  2800              CMP      r0,#0                 ;444
0006a2  dd3f              BLE      |L9.1828|
0006a4  2000              MOVS     r0,#0                 ;446
0006a6  4960              LDR      r1,|L9.2088|
0006a8  3924              SUBS     r1,r1,#0x24           ;446
0006aa  7308              STRB     r0,[r1,#0xc]          ;446
0006ac  4608              MOV      r0,r1                 ;447
0006ae  7800              LDRB     r0,[r0,#0]            ;447  ; lock
0006b0  900a              STR      r0,[sp,#0x28]         ;447
0006b2  485a              LDR      r0,|L9.2076|
0006b4  7dc0              LDRB     r0,[r0,#0x17]         ;449  ; wbuf
0006b6  2801              CMP      r0,#1                 ;449
0006b8  d00b              BEQ      |L9.1746|
0006ba  4858              LDR      r0,|L9.2076|
0006bc  7dc0              LDRB     r0,[r0,#0x17]         ;449  ; wbuf
0006be  2802              CMP      r0,#2                 ;449
0006c0  d007              BEQ      |L9.1746|
0006c2  4856              LDR      r0,|L9.2076|
0006c4  7dc0              LDRB     r0,[r0,#0x17]         ;449  ; wbuf
0006c6  2803              CMP      r0,#3                 ;449
0006c8  d003              BEQ      |L9.1746|
0006ca  4854              LDR      r0,|L9.2076|
0006cc  7dc0              LDRB     r0,[r0,#0x17]         ;449  ; wbuf
0006ce  2805              CMP      r0,#5                 ;449
0006d0  d101              BNE      |L9.1750|
                  |L9.1746|
0006d2  26bb              MOVS     r6,#0xbb              ;449
0006d4  e000              B        |L9.1752|
                  |L9.1750|
0006d6  26ff              MOVS     r6,#0xff              ;450
                  |L9.1752|
0006d8  4632              MOV      r2,r6                 ;453
0006da  2102              MOVS     r1,#2                 ;453
0006dc  f89d0028          LDRB     r0,[sp,#0x28]         ;453
0006e0  f7fffffe          BL       IT1_Lock_DataLoad
0006e4  484d              LDR      r0,|L9.2076|
0006e6  7d41              LDRB     r1,[r0,#0x15]         ;454  ; wbuf
0006e8  7d80              LDRB     r0,[r0,#0x16]         ;454  ; wbuf
0006ea  eb012000          ADD      r0,r1,r0,LSL #8       ;454
0006ee  b282              UXTH     r2,r0                 ;454
0006f0  484d              LDR      r0,|L9.2088|
0006f2  3824              SUBS     r0,r0,#0x24           ;454
0006f4  7800              LDRB     r0,[r0,#0]            ;454  ; lock
0006f6  1e40              SUBS     r0,r0,#1              ;454
0006f8  494d              LDR      r1,|L9.2096|
0006fa  f8212010          STRH     r2,[r1,r0,LSL #1]     ;454
0006fe  2200              MOVS     r2,#0                 ;455
000700  4849              LDR      r0,|L9.2088|
000702  3824              SUBS     r0,r0,#0x24           ;455
000704  7800              LDRB     r0,[r0,#0]            ;455  ; lock
000706  1e40              SUBS     r0,r0,#1              ;455
000708  3120              ADDS     r1,r1,#0x20           ;455
00070a  540a              STRB     r2,[r1,r0]            ;455
00070c  4846              LDR      r0,|L9.2088|
00070e  3824              SUBS     r0,r0,#0x24           ;456
000710  7800              LDRB     r0,[r0,#0]            ;456  ; lock
000712  1e40              SUBS     r0,r0,#1              ;456
000714  3110              ADDS     r1,r1,#0x10           ;456
000716  540a              STRB     r2,[r1,r0]            ;456
000718  4943              LDR      r1,|L9.2088|
00071a  3924              SUBS     r1,r1,#0x24           ;457
00071c  7808              LDRB     r0,[r1,#0]            ;457  ; lock
00071e  f7fffffe          BL       Write_Lock_Table
                  |L9.1826|
000722  e1a1              B        |L9.2664|
                  |L9.1828|
000724  483d              LDR      r0,|L9.2076|
000726  7dc0              LDRB     r0,[r0,#0x17]         ;462  ; wbuf
000728  2801              CMP      r0,#1                 ;462
00072a  d00b              BEQ      |L9.1860|
00072c  483b              LDR      r0,|L9.2076|
00072e  7dc0              LDRB     r0,[r0,#0x17]         ;462  ; wbuf
000730  2802              CMP      r0,#2                 ;462
000732  d007              BEQ      |L9.1860|
000734  4839              LDR      r0,|L9.2076|
000736  7dc0              LDRB     r0,[r0,#0x17]         ;462  ; wbuf
000738  2803              CMP      r0,#3                 ;462
00073a  d003              BEQ      |L9.1860|
00073c  4837              LDR      r0,|L9.2076|
00073e  7dc0              LDRB     r0,[r0,#0x17]         ;462  ; wbuf
000740  2805              CMP      r0,#5                 ;462
000742  d120              BNE      |L9.1926|
                  |L9.1860|
000744  4838              LDR      r0,|L9.2088|
000746  3824              SUBS     r0,r0,#0x24           ;464
000748  8c40              LDRH     r0,[r0,#0x22]         ;464
00074a  f0400101          ORR      r1,r0,#1              ;464
00074e  4836              LDR      r0,|L9.2088|
000750  3824              SUBS     r0,r0,#0x24           ;464
000752  8441              STRH     r1,[r0,#0x22]         ;464
000754  f8902022          LDRB     r2,[r0,#0x22]         ;465
000758  2101              MOVS     r1,#1                 ;465
00075a  2000              MOVS     r0,#0                 ;465
00075c  f7fffffe          BL       IT1_Lock_DataLoad
000760  4831              LDR      r0,|L9.2088|
000762  3824              SUBS     r0,r0,#0x24           ;468
000764  7cc0              LDRB     r0,[r0,#0x13]         ;468
000766  b930              CBNZ     r0,|L9.1910|
000768  482f              LDR      r0,|L9.2088|
00076a  3824              SUBS     r0,r0,#0x24           ;468
00076c  f8900022          LDRB     r0,[r0,#0x22]         ;468
000770  f0100f02          TST      r0,#2                 ;468
000774  d090              BEQ      |L9.1688|
                  |L9.1910|
000776  f44f737a          MOV      r3,#0x3e8             ;470
00077a  2205              MOVS     r2,#5                 ;470
00077c  2103              MOVS     r1,#3                 ;470
00077e  2000              MOVS     r0,#0                 ;470
000780  f7fffffe          BL       DlyEvent_handle
                  |L9.1924|
000784  e170              B        |L9.2664|
                  |L9.1926|
000786  4825              LDR      r0,|L9.2076|
000788  7dc0              LDRB     r0,[r0,#0x17]         ;474  ; wbuf
00078a  2800              CMP      r0,#0                 ;474
00078c  d184              BNE      |L9.1688|
00078e  4826              LDR      r0,|L9.2088|
000790  3824              SUBS     r0,r0,#0x24           ;476
000792  f8900022          LDRB     r0,[r0,#0x22]         ;476
000796  f00001fe          AND      r1,r0,#0xfe           ;476
00079a  4823              LDR      r0,|L9.2088|
00079c  3824              SUBS     r0,r0,#0x24           ;476
00079e  8441              STRH     r1,[r0,#0x22]         ;476
0007a0  f8902022          LDRB     r2,[r0,#0x22]         ;477
0007a4  2101              MOVS     r1,#1                 ;477
0007a6  2000              MOVS     r0,#0                 ;477
0007a8  f7fffffe          BL       IT1_Lock_DataLoad
0007ac  481e              LDR      r0,|L9.2088|
0007ae  3824              SUBS     r0,r0,#0x24           ;480
0007b0  7cc0              LDRB     r0,[r0,#0x13]         ;480
0007b2  b930              CBNZ     r0,|L9.1986|
0007b4  481c              LDR      r0,|L9.2088|
0007b6  3824              SUBS     r0,r0,#0x24           ;480
0007b8  f8900022          LDRB     r0,[r0,#0x22]         ;480
0007bc  f0100f02          TST      r0,#2                 ;480
0007c0  d0af              BEQ      |L9.1826|
                  |L9.1986|
0007c2  2000              MOVS     r0,#0                 ;482
0007c4  9002              STR      r0,[sp,#8]            ;482
0007c6  2060              MOVS     r0,#0x60              ;482
0007c8  9002              STR      r0,[sp,#8]            ;482
0007ca  f44f737a          MOV      r3,#0x3e8             ;483
0007ce  2206              MOVS     r2,#6                 ;483
0007d0  2103              MOVS     r1,#3                 ;483
0007d2  2000              MOVS     r0,#0                 ;483
0007d4  f7fffffe          BL       DlyEvent_handle
                  |L9.2008|
0007d8  e146              B        |L9.2664|
                  |L9.2010|
0007da  4810              LDR      r0,|L9.2076|
0007dc  7840              LDRB     r0,[r0,#1]            ;496  ; wbuf
0007de  2800              CMP      r0,#0                 ;496
0007e0  d19f              BNE      |L9.1826|
0007e2  a90a              ADD      r1,sp,#0x28           ;499
0007e4  4813              LDR      r0,|L9.2100|
0007e6  f7fffffe          BL       GetQueue_OutQ
0007ea  4605              MOV      r5,r0                 ;499
0007ec  b905              CBNZ     r5,|L9.2032|
0007ee  e449              B        |L9.132|
                  |L9.2032|
0007f0  f89500cd          LDRB     r0,[r5,#0xcd]         ;501
0007f4  2800              CMP      r0,#0                 ;501
0007f6  d094              BEQ      |L9.1826|
0007f8  79a8              LDRB     r0,[r5,#6]            ;501
0007fa  4908              LDR      r1,|L9.2076|
0007fc  7989              LDRB     r1,[r1,#6]            ;501  ; wbuf
0007fe  4288              CMP      r0,r1                 ;501
000800  d18f              BNE      |L9.1826|
000802  79e8              LDRB     r0,[r5,#7]            ;501
000804  4905              LDR      r1,|L9.2076|
000806  79c9              LDRB     r1,[r1,#7]            ;501  ; wbuf
000808  4288              CMP      r0,r1                 ;501
00080a  d18a              BNE      |L9.1826|
00080c  7a28              LDRB     r0,[r5,#8]            ;502
00080e  4903              LDR      r1,|L9.2076|
000810  7a09              LDRB     r1,[r1,#8]            ;502  ; wbuf
000812  4288              CMP      r0,r1                 ;502
000814  d185              BNE      |L9.1826|
000816  7a68              LDRB     r0,[r5,#9]            ;502
000818  4900              LDR      r1,|L9.2076|
00081a  e00d              B        |L9.2104|
                  |L9.2076|
                          DCD      wbuf
                  |L9.2080|
                          DCD      ||Dev||
                  |L9.2084|
                          DCD      Ex_Table+0x16
                  |L9.2088|
                          DCD      lock+0x24
                  |L9.2092|
                          DCD      Pannel+0x9
                  |L9.2096|
                          DCD      LockItem+0x16
                  |L9.2100|
                          DCD      WirelessSend_Queue
                  |L9.2104|
000838  7a49              LDRB     r1,[r1,#9]            ;502  ; wbuf
00083a  4288              CMP      r0,r1                 ;502
00083c  d1a2              BNE      |L9.1924|
00083e  2400              MOVS     r4,#0                 ;504
000840  e003              B        |L9.2122|
                  |L9.2114|
000842  2000              MOVS     r0,#0                 ;504
000844  5528              STRB     r0,[r5,r4]            ;504
000846  1c60              ADDS     r0,r4,#1              ;504
000848  b2c4              UXTB     r4,r0                 ;504
                  |L9.2122|
00084a  f89500c8          LDRB     r0,[r5,#0xc8]         ;504
00084e  42a0              CMP      r0,r4                 ;504
000850  dcf7              BGT      |L9.2114|
000852  2000              MOVS     r0,#0                 ;505
000854  f8050fc8          STRB     r0,[r5,#0xc8]!        ;505
000858  7068              STRB     r0,[r5,#1]            ;506
00085a  7168              STRB     r0,[r5,#5]            ;507
00085c  f1a505c8          SUB      r5,r5,#0xc8           ;507
000860  f89d1028          LDRB     r1,[sp,#0x28]         ;508
000864  4887              LDR      r0,|L9.2692|
000866  f7fffffe          BL       DeQueueBuf
00086a  e0fd              B        |L9.2664|
                  |L9.2156|
00086c  4886              LDR      r0,|L9.2696|
00086e  7980              LDRB     r0,[r0,#6]            ;518  ; Dev
000870  2803              CMP      r0,#3                 ;518
000872  d187              BNE      |L9.1924|
000874  4884              LDR      r0,|L9.2696|
000876  7ac0              LDRB     r0,[r0,#0xb]          ;521  ; Dev
000878  2800              CMP      r0,#0                 ;521
00087a  dd7d              BLE      |L9.2424|
00087c  4882              LDR      r0,|L9.2696|
00087e  8880              LDRH     r0,[r0,#4]            ;523  ; Dev
000880  f4004070          AND      r0,r0,#0xf000         ;523
000884  f5b04f30          CMP      r0,#0xb000            ;523
000888  d177              BNE      |L9.2426|
00088a  4880              LDR      r0,|L9.2700|
00088c  7840              LDRB     r0,[r0,#1]            ;525  ; wbuf
00088e  f0000080          AND      r0,r0,#0x80           ;525
000892  2880              CMP      r0,#0x80              ;525
000894  d11a              BNE      |L9.2252|
000896  487d              LDR      r0,|L9.2700|
000898  7840              LDRB     r0,[r0,#1]            ;528  ; wbuf
00089a  2811              CMP      r0,#0x11              ;528
00089c  d003              BEQ      |L9.2214|
00089e  487b              LDR      r0,|L9.2700|
0008a0  7840              LDRB     r0,[r0,#1]            ;528  ; wbuf
0008a2  2812              CMP      r0,#0x12              ;528
0008a4  d198              BNE      |L9.2008|
                  |L9.2214|
0008a6  4879              LDR      r0,|L9.2700|
0008a8  7880              LDRB     r0,[r0,#2]            ;528  ; wbuf
0008aa  28ff              CMP      r0,#0xff              ;528
0008ac  d10d              BNE      |L9.2250|
0008ae  4877              LDR      r0,|L9.2700|
0008b0  78c0              LDRB     r0,[r0,#3]            ;528  ; wbuf
0008b2  28ff              CMP      r0,#0xff              ;528
0008b4  d109              BNE      |L9.2250|
0008b6  4875              LDR      r0,|L9.2700|
0008b8  7900              LDRB     r0,[r0,#4]            ;528  ; wbuf
0008ba  28ff              CMP      r0,#0xff              ;528
0008bc  d105              BNE      |L9.2250|
0008be  4873              LDR      r0,|L9.2700|
0008c0  7940              LDRB     r0,[r0,#5]            ;528  ; wbuf
0008c2  28ff              CMP      r0,#0xff              ;528
0008c4  d101              BNE      |L9.2250|
0008c6  f7fffffe          BL       Wireless_Learn_Finish
                  |L9.2250|
0008ca  e0cd              B        |L9.2664|
                  |L9.2252|
0008cc  2400              MOVS     r4,#0                 ;568
0008ce  e007              B        |L9.2272|
                  |L9.2256|
0008d0  f104000a          ADD      r0,r4,#0xa            ;568
0008d4  496d              LDR      r1,|L9.2700|
0008d6  5c08              LDRB     r0,[r1,r0]            ;568
0008d8  a906              ADD      r1,sp,#0x18           ;568
0008da  5508              STRB     r0,[r1,r4]            ;568
0008dc  1c60              ADDS     r0,r4,#1              ;568
0008de  b2c4              UXTB     r4,r0                 ;568
                  |L9.2272|
0008e0  2c04              CMP      r4,#4                 ;568
0008e2  dbf5              BLT      |L9.2256|
0008e4  2300              MOVS     r3,#0                 ;569
0008e6  2204              MOVS     r2,#4                 ;569
0008e8  a906              ADD      r1,sp,#0x18           ;569
0008ea  4868              LDR      r0,|L9.2700|
0008ec  1d80              ADDS     r0,r0,#6              ;569
0008ee  f7fffffe          BL       ComposePacketFromDS28E02
0008f2  2400              MOVS     r4,#0                 ;570
0008f4  e007              B        |L9.2310|
                  |L9.2294|
0008f6  a806              ADD      r0,sp,#0x18           ;570
0008f8  5d01              LDRB     r1,[r0,r4]            ;570
0008fa  f104000a          ADD      r0,r4,#0xa            ;570
0008fe  4a63              LDR      r2,|L9.2700|
000900  5411              STRB     r1,[r2,r0]            ;570
000902  1c60              ADDS     r0,r4,#1              ;570
000904  b2c4              UXTB     r4,r0                 ;570
                  |L9.2310|
000906  2c04              CMP      r4,#4                 ;570
000908  dbf5              BLT      |L9.2294|
00090a  4860              LDR      r0,|L9.2700|
00090c  7840              LDRB     r0,[r0,#1]            ;573  ; wbuf
00090e  280b              CMP      r0,#0xb               ;573
000910  d119              BNE      |L9.2374|
000912  485e              LDR      r0,|L9.2700|
000914  7b00              LDRB     r0,[r0,#0xc]          ;577  ; wbuf
000916  28ff              CMP      r0,#0xff              ;577
000918  d102              BNE      |L9.2336|
00091a  f7fffffe          BL       Wireless_Learn_Finish
00091e  e0a3              B        |L9.2664|
                  |L9.2336|
000920  4a5a              LDR      r2,|L9.2700|
000922  7b51              LDRB     r1,[r2,#0xd]          ;584  ; wbuf
000924  7b10              LDRB     r0,[r2,#0xc]          ;584  ; wbuf
000926  f7fffffe          BL       IT1_RS4852Wireless
00092a  9004              STR      r0,[sp,#0x10]         ;584
00092c  f89d0028          LDRB     r0,[sp,#0x28]         ;585
000930  ebc001c0          RSB      r1,r0,r0,LSL #3       ;585
000934  4856              LDR      r0,|L9.2704|
000936  f8101011          LDRB     r1,[r0,r1,LSL #1]     ;585
00093a  9804              LDR      r0,[sp,#0x10]         ;585
00093c  4281              CMP      r1,r0                 ;585
00093e  d101              BNE      |L9.2372|
000940  f7fffffe          BL       Wireless_Learn_Finish
                  |L9.2372|
000944  e090              B        |L9.2664|
                  |L9.2374|
000946  4851              LDR      r0,|L9.2700|
000948  7840              LDRB     r0,[r0,#1]            ;592  ; wbuf
00094a  2810              CMP      r0,#0x10              ;592
00094c  d131              BNE      |L9.2482|
00094e  484f              LDR      r0,|L9.2700|
000950  7880              LDRB     r0,[r0,#2]            ;592  ; wbuf
000952  28ff              CMP      r0,#0xff              ;592
000954  d12d              BNE      |L9.2482|
000956  484d              LDR      r0,|L9.2700|
000958  78c0              LDRB     r0,[r0,#3]            ;592  ; wbuf
00095a  28ff              CMP      r0,#0xff              ;592
00095c  d129              BNE      |L9.2482|
00095e  484b              LDR      r0,|L9.2700|
000960  7900              LDRB     r0,[r0,#4]            ;592  ; wbuf
000962  28ff              CMP      r0,#0xff              ;592
000964  d125              BNE      |L9.2482|
000966  4849              LDR      r0,|L9.2700|
000968  7940              LDRB     r0,[r0,#5]            ;592  ; wbuf
00096a  28ff              CMP      r0,#0xff              ;592
00096c  d17c              BNE      |L9.2664|
00096e  4849              LDR      r0,|L9.2708|
000970  7800              LDRB     r0,[r0,#0]            ;594  ; step
000972  b9f8              CBNZ     r0,|L9.2484|
000974  4848              LDR      r0,|L9.2712|
000976  e001              B        |L9.2428|
                  |L9.2424|
000978  e05c              B        |L9.2612|
                  |L9.2426|
00097a  e046              B        |L9.2570|
                  |L9.2428|
00097c  7840              LDRB     r0,[r0,#1]            ;596  ; Exchangebuf
00097e  900a              STR      r0,[sp,#0x28]         ;596
000980  4842              LDR      r0,|L9.2700|
000982  7980              LDRB     r0,[r0,#6]            ;597  ; wbuf
000984  4944              LDR      r1,|L9.2712|
000986  70c8              STRB     r0,[r1,#3]            ;597
000988  4840              LDR      r0,|L9.2700|
00098a  79c1              LDRB     r1,[r0,#7]            ;598  ; wbuf
00098c  4842              LDR      r0,|L9.2712|
00098e  7101              STRB     r1,[r0,#4]            ;598
000990  483e              LDR      r0,|L9.2700|
000992  7a01              LDRB     r1,[r0,#8]            ;599  ; wbuf
000994  4840              LDR      r0,|L9.2712|
000996  7141              STRB     r1,[r0,#5]            ;599
000998  483c              LDR      r0,|L9.2700|
00099a  7a40              LDRB     r0,[r0,#9]            ;600  ; wbuf
00099c  493e              LDR      r1,|L9.2712|
00099e  7188              STRB     r0,[r1,#6]            ;600
0009a0  483c              LDR      r0,|L9.2708|
0009a2  7800              LDRB     r0,[r0,#0]            ;601  ; step
0009a4  1c40              ADDS     r0,r0,#1              ;601
0009a6  493b              LDR      r1,|L9.2708|
0009a8  7008              STRB     r0,[r1,#0]            ;601
0009aa  21c8              MOVS     r1,#0xc8              ;602
0009ac  4837              LDR      r0,|L9.2700|
0009ae  f7fffffe          BL       Wireless_Recv_Disable
                  |L9.2482|
0009b2  e059              B        |L9.2664|
                  |L9.2484|
0009b4  4838              LDR      r0,|L9.2712|
0009b6  78c0              LDRB     r0,[r0,#3]            ;606  ; Exchangebuf
0009b8  4934              LDR      r1,|L9.2700|
0009ba  7989              LDRB     r1,[r1,#6]            ;606  ; wbuf
0009bc  4288              CMP      r0,r1                 ;606
0009be  d153              BNE      |L9.2664|
0009c0  4835              LDR      r0,|L9.2712|
0009c2  7900              LDRB     r0,[r0,#4]            ;606
0009c4  4931              LDR      r1,|L9.2700|
0009c6  79c9              LDRB     r1,[r1,#7]            ;606  ; wbuf
0009c8  4288              CMP      r0,r1                 ;606
0009ca  d14d              BNE      |L9.2664|
0009cc  4832              LDR      r0,|L9.2712|
0009ce  7940              LDRB     r0,[r0,#5]            ;607
0009d0  492e              LDR      r1,|L9.2700|
0009d2  7a09              LDRB     r1,[r1,#8]            ;607  ; wbuf
0009d4  4288              CMP      r0,r1                 ;607
0009d6  d147              BNE      |L9.2664|
0009d8  482f              LDR      r0,|L9.2712|
0009da  7980              LDRB     r0,[r0,#6]            ;607  ; Exchangebuf
0009dc  492b              LDR      r1,|L9.2700|
0009de  7a49              LDRB     r1,[r1,#9]            ;607  ; wbuf
0009e0  4288              CMP      r0,r1                 ;607
0009e2  d141              BNE      |L9.2664|
0009e4  482b              LDR      r0,|L9.2708|
0009e6  7800              LDRB     r0,[r0,#0]            ;609  ; step
0009e8  1c40              ADDS     r0,r0,#1              ;609
0009ea  492a              LDR      r1,|L9.2708|
0009ec  7008              STRB     r0,[r1,#0]            ;609
0009ee  21c8              MOVS     r1,#0xc8              ;610
0009f0  4826              LDR      r0,|L9.2700|
0009f2  f7fffffe          BL       Wireless_Recv_Disable
0009f6  4827              LDR      r0,|L9.2708|
0009f8  7800              LDRB     r0,[r0,#0]            ;611  ; step
0009fa  2803              CMP      r0,#3                 ;611
0009fc  db34              BLT      |L9.2664|
0009fe  f7fffffe          BL       Wireless_Learn_Finish
000a02  2000              MOVS     r0,#0                 ;614
000a04  4923              LDR      r1,|L9.2708|
000a06  7008              STRB     r0,[r1,#0]            ;614
000a08  e02e              B        |L9.2664|
                  |L9.2570|
000a0a  481f              LDR      r0,|L9.2696|
000a0c  8880              LDRH     r0,[r0,#4]            ;623  ; Dev
000a0e  f4004070          AND      r0,r0,#0xf000         ;623
000a12  f5b05f40          CMP      r0,#0x3000            ;623
000a16  d127              BNE      |L9.2664|
000a18  481c              LDR      r0,|L9.2700|
000a1a  7840              LDRB     r0,[r0,#1]            ;632  ; wbuf
000a1c  280b              CMP      r0,#0xb               ;632
000a1e  d123              BNE      |L9.2664|
000a20  481a              LDR      r0,|L9.2700|
000a22  7b00              LDRB     r0,[r0,#0xc]          ;634  ; wbuf
000a24  28f0              CMP      r0,#0xf0              ;634
000a26  d11f              BNE      |L9.2664|
000a28  2000              MOVS     r0,#0                 ;636
000a2a  491c              LDR      r1,|L9.2716|
000a2c  7008              STRB     r0,[r1,#0]            ;636
000a2e  f7fffffe          BL       WlLock_Learn_Finish
000a32  e019              B        |L9.2664|
                  |L9.2612|
000a34  2002              MOVS     r0,#2                 ;648
000a36  4914              LDR      r1,|L9.2696|
000a38  7188              STRB     r0,[r1,#6]            ;648
000a3a  2000              MOVS     r0,#0                 ;650
000a3c  4915              LDR      r1,|L9.2708|
000a3e  7008              STRB     r0,[r1,#0]            ;650
000a40  20ff              MOVS     r0,#0xff              ;652
000a42  4915              LDR      r1,|L9.2712|
000a44  7048              STRB     r0,[r1,#1]            ;652
000a46  7008              STRB     r0,[r1,#0]            ;653
000a48  70c8              STRB     r0,[r1,#3]            ;654
000a4a  21ff              MOVS     r1,#0xff              ;655
000a4c  4812              LDR      r0,|L9.2712|
000a4e  7101              STRB     r1,[r0,#4]            ;655
000a50  7141              STRB     r1,[r0,#5]            ;656
000a52  20ff              MOVS     r0,#0xff              ;657
000a54  4910              LDR      r1,|L9.2712|
000a56  7188              STRB     r0,[r1,#6]            ;657
000a58  2002              MOVS     r0,#2                 ;659
000a5a  2301              MOVS     r3,#1                 ;659
000a5c  2219              MOVS     r2,#0x19              ;659
000a5e  4611              MOV      r1,r2                 ;659
000a60  9000              STR      r0,[sp,#0]            ;659
000a62  4618              MOV      r0,r3                 ;659
000a64  f7fffffe          BL       Led_set
                  |L9.2664|
000a68  480d              LDR      r0,|L9.2720|
000a6a  8800              LDRH     r0,[r0,#0]            ;669  ; CC1101_ResetTime
000a6c  f5b07f96          CMP      r0,#0x12c             ;669
000a70  dd05              BLE      |L9.2686|
000a72  2000              MOVS     r0,#0                 ;671
000a74  490a              LDR      r1,|L9.2720|
000a76  8008              STRH     r0,[r1,#0]            ;671
000a78  2001              MOVS     r0,#1                 ;673
000a7a  f7fffffe          BL       bsp_InitRF
                  |L9.2686|
000a7e  bf00              NOP      
000a80  e415              B        |L9.686|
;;;680    //=======================================================================================================
                          ENDP

000a82  0000              DCW      0x0000
                  |L9.2692|
                          DCD      WirelessSend_Queue
                  |L9.2696|
                          DCD      ||Dev||
                  |L9.2700|
                          DCD      wbuf
                  |L9.2704|
                          DCD      Ex_Table+0x36
                  |L9.2708|
                          DCD      step
                  |L9.2712|
                          DCD      Exchangebuf
                  |L9.2716|
                          DCD      lock
                  |L9.2720|
                          DCD      CC1101_ResetTime

                          AREA ||i.Wireless_Recv_Disable||, CODE, READONLY, ALIGN=2

                  Wireless_Recv_Disable PROC
;;;1092   //在指定时间内，禁止接收同样帧
;;;1093   void Wireless_Recv_Disable(uint8_t *pdat,uint8_t time)
000000  b510              PUSH     {r4,lr}
;;;1094   {
000002  4602              MOV      r2,r0
;;;1095   	uint8_t i;
;;;1096   	for(i=0;i<16;i++)wl_frame[i]=*(pdat+i);
000004  2000              MOVS     r0,#0
000006  e004              B        |L10.18|
                  |L10.8|
000008  5c13              LDRB     r3,[r2,r0]
00000a  4c04              LDR      r4,|L10.28|
00000c  5423              STRB     r3,[r4,r0]
00000e  1c43              ADDS     r3,r0,#1
000010  b2d8              UXTB     r0,r3
                  |L10.18|
000012  2810              CMP      r0,#0x10
000014  dbf8              BLT      |L10.8|
;;;1097   	dis_tim=time;
000016  4b02              LDR      r3,|L10.32|
000018  7019              STRB     r1,[r3,#0]
;;;1098   	
;;;1099   }
00001a  bd10              POP      {r4,pc}
;;;1100   //=============================================================================================
                          ENDP

                  |L10.28|
                          DCD      wl_frame
                  |L10.32|
                          DCD      dis_tim

                          AREA ||i.Wireless_Recv_IsRun||, CODE, READONLY, ALIGN=2

                  Wireless_Recv_IsRun PROC
;;;1101   //判断是否处理接收到的帧
;;;1102   uint8_t Wireless_Recv_IsRun(uint8_t *pdat)
000000  4601              MOV      r1,r0
;;;1103   {
;;;1104   #if 0
;;;1105   	uint8_t i,err;
;;;1106   	
;;;1107   	if(dis_tim==0)
;;;1108   	{
;;;1109   		  for(i=0;i<16;i++)wl_frame[i]=0x00;
;;;1110   			return OPT_OK;
;;;1111   	}
;;;1112   	else
;;;1113   	{
;;;1114   		
;;;1115   		  err=OPT_ERR;
;;;1116   		
;;;1117   		  for(i=0;i<16;i++)
;;;1118   		  {
;;;1119   					if(wl_frame[i]!=*(pdat+i))
;;;1120   					{
;;;1121   						  err=OPT_OK;
;;;1122   							break;
;;;1123   					}
;;;1124   			}
;;;1125   			return err;
;;;1126   	}
;;;1127   #else
;;;1128   	    uint8_t err;
;;;1129   	
;;;1130   			err=OPT_OK;
000002  20fb              MOVS     r0,#0xfb
;;;1131   		  //如果同步数相同，则退出
;;;1132   			if((wl_frame[10]==*(pdat+10))&&(wl_frame[11]==*(pdat+11)))
000004  4a05              LDR      r2,|L11.28|
000006  7a92              LDRB     r2,[r2,#0xa]  ; wl_frame
000008  7a8b              LDRB     r3,[r1,#0xa]
00000a  429a              CMP      r2,r3
00000c  d105              BNE      |L11.26|
00000e  4a03              LDR      r2,|L11.28|
000010  7ad2              LDRB     r2,[r2,#0xb]  ; wl_frame
000012  7acb              LDRB     r3,[r1,#0xb]
000014  429a              CMP      r2,r3
000016  d100              BNE      |L11.26|
;;;1133   			{
;;;1134   					err=OPT_ERR;
000018  20fc              MOVS     r0,#0xfc
                  |L11.26|
;;;1135   			}
;;;1136   			return err;
;;;1137   #endif
;;;1138   }
00001a  4770              BX       lr
;;;1139   
                          ENDP

                  |L11.28|
                          DCD      wl_frame

                          AREA ||i.Wireless_Send||, CODE, READONLY, ALIGN=2

                  Wireless_Send PROC
;;;33     //每隔100mS调用一次
;;;34     void Wireless_Send(void)
000000  b538              PUSH     {r3-r5,lr}
;;;35     {
;;;36     				_Frame *pws;
;;;37     				uint8_t i,index;
;;;38     				
;;;39     				//pws=GetQueue_rear(&WirelessSend_Queue);
;;;40     	      pws=GetQueue_OutQ(&WirelessSend_Queue,&index);
000002  4669              MOV      r1,sp
000004  4840              LDR      r0,|L12.264|
000006  f7fffffe          BL       GetQueue_OutQ
00000a  4604              MOV      r4,r0
;;;41     				//判断是否接收缓冲区为空
;;;42     				if(pws==NULL)
00000c  b904              CBNZ     r4,|L12.16|
                  |L12.14|
;;;43     				{
;;;44     					return;
;;;45     				}
;;;46     				
;;;47     				//============================================================================================
;;;48     				if(pws->flag==1)				//有数据要发送
;;;49     				{
;;;50     					if(pws->ackwait>0)			//正在等待应答，不发送
;;;51     					{
;;;52     						pws->ackwait--;
;;;53     						if(pws->ackwait==0)
;;;54     						{
;;;55     							if(pws->resend>0)       //重发次数减去-    
;;;56     							{
;;;57     										pws->resend--;
;;;58     										//pws->rand=Dev.rand%3;//随机时间为0~150mS之间
;;;59     								    pws->rand=1;//随机时间为0~150mS之间
;;;60     							}
;;;61     							else
;;;62     							{
;;;63     										//这帧退出缓冲区，不在发送
;;;64     										for(i=0;i<pws->cnt;i++)pws->buf[i]=0x00;
;;;65     										pws->cnt=0;
;;;66     										pws->flag=0;
;;;67     										pws->ackwait=0;
;;;68     										//DeQueueBuf(&WirelessSend_Queue);
;;;69     										DeQueueBuf(&WirelessSend_Queue,index);
;;;70     								
;;;71     										if(Ir.wait==1)Ir.wait=0;																//2017.1.12
;;;72     							}
;;;73     						}
;;;74     					}
;;;75     					else
;;;76     					{
;;;77     						if(pws->rand==0)			//延时时间到，可以发送数据
;;;78     						{
;;;79     									#ifdef USE_A7139
;;;80     							    RF_TX(pws->buf,pws->cnt);
;;;81     									bsp_InitRF(0);
;;;82     							    #else
;;;83     									RfSendPacket(pws->buf,pws->cnt);      //发送数据
;;;84     									//bsp_InitCC1101();
;;;85     							    #endif
;;;86     									
;;;87     									if(pws->resend==1)     i=3;
;;;88     									else if(pws->resend==2)i=2;
;;;89     									else                   i=1;
;;;90     									
;;;91     									pws->ackwait=i;		//等待应答时间为150mS
;;;92     							
;;;93     						}
;;;94     						else
;;;95     						{
;;;96     									pws->rand--;
;;;97     						}
;;;98     					}
;;;99     				}
;;;100    				//数据发送完成
;;;101    				else
;;;102    				{
;;;103    									for(i=0;i<pws->cnt;i++)pws->buf[i]=0x00;
;;;104    									pws->cnt=0;
;;;105    									pws->flag=0;
;;;106    									pws->ackwait=0;
;;;107    									//DeQueueBuf(&WirelessSend_Queue);
;;;108    									DeQueueBuf(&WirelessSend_Queue,index);
;;;109    									
;;;110    									if(Ir.wait==1)Ir.wait=0;																//2017.1.12
;;;111    				}
;;;112    }
00000e  bd38              POP      {r3-r5,pc}
                  |L12.16|
000010  f89400c9          LDRB     r0,[r4,#0xc9]         ;48
000014  2801              CMP      r0,#1                 ;48
000016  d157              BNE      |L12.200|
000018  f89400cd          LDRB     r0,[r4,#0xcd]         ;50
00001c  2800              CMP      r0,#0                 ;50
00001e  dd32              BLE      |L12.134|
000020  f8140fcd          LDRB     r0,[r4,#0xcd]!        ;52
000024  1e40              SUBS     r0,r0,#1              ;52
000026  7020              STRB     r0,[r4,#0]            ;52
000028  f81409cd          LDRB     r0,[r4],#-0xcd        ;53
00002c  2800              CMP      r0,#0                 ;53
00002e  d168              BNE      |L12.258|
000030  f89400ca          LDRB     r0,[r4,#0xca]         ;55
000034  2800              CMP      r0,#0                 ;55
000036  dd08              BLE      |L12.74|
000038  f8140fca          LDRB     r0,[r4,#0xca]!        ;57
00003c  1e40              SUBS     r0,r0,#1              ;57
00003e  7020              STRB     r0,[r4,#0]            ;57
000040  2001              MOVS     r0,#1                 ;59
000042  70a0              STRB     r0,[r4,#2]            ;59
000044  f1a404ca          SUB      r4,r4,#0xca           ;59
000048  e05b              B        |L12.258|
                  |L12.74|
00004a  2500              MOVS     r5,#0                 ;64
00004c  e003              B        |L12.86|
                  |L12.78|
00004e  2000              MOVS     r0,#0                 ;64
000050  5560              STRB     r0,[r4,r5]            ;64
000052  1c68              ADDS     r0,r5,#1              ;64
000054  b2c5              UXTB     r5,r0                 ;64
                  |L12.86|
000056  f89400c8          LDRB     r0,[r4,#0xc8]         ;64
00005a  42a8              CMP      r0,r5                 ;64
00005c  dcf7              BGT      |L12.78|
00005e  2000              MOVS     r0,#0                 ;65
000060  f8040fc8          STRB     r0,[r4,#0xc8]!        ;65
000064  7060              STRB     r0,[r4,#1]            ;66
000066  7160              STRB     r0,[r4,#5]            ;67
000068  f1a404c8          SUB      r4,r4,#0xc8           ;67
00006c  f89d1000          LDRB     r1,[sp,#0]            ;69
000070  4825              LDR      r0,|L12.264|
000072  f7fffffe          BL       DeQueueBuf
000076  4825              LDR      r0,|L12.268|
000078  7880              LDRB     r0,[r0,#2]            ;71  ; Ir
00007a  2801              CMP      r0,#1                 ;71
00007c  d141              BNE      |L12.258|
00007e  2000              MOVS     r0,#0                 ;71
000080  4922              LDR      r1,|L12.268|
000082  7088              STRB     r0,[r1,#2]            ;71
000084  e03d              B        |L12.258|
                  |L12.134|
000086  f89400cc          LDRB     r0,[r4,#0xcc]         ;77
00008a  b9b8              CBNZ     r0,|L12.188|
00008c  f89410c8          LDRB     r1,[r4,#0xc8]         ;80
000090  4620              MOV      r0,r4                 ;80
000092  f7fffffe          BL       RF_TX
000096  2000              MOVS     r0,#0                 ;81
000098  f7fffffe          BL       bsp_InitRF
00009c  f89400ca          LDRB     r0,[r4,#0xca]         ;87
0000a0  2801              CMP      r0,#1                 ;87
0000a2  d101              BNE      |L12.168|
0000a4  2503              MOVS     r5,#3                 ;87
0000a6  e006              B        |L12.182|
                  |L12.168|
0000a8  f89400ca          LDRB     r0,[r4,#0xca]         ;88
0000ac  2802              CMP      r0,#2                 ;88
0000ae  d101              BNE      |L12.180|
0000b0  2502              MOVS     r5,#2                 ;88
0000b2  e000              B        |L12.182|
                  |L12.180|
0000b4  2501              MOVS     r5,#1                 ;89
                  |L12.182|
0000b6  f88450cd          STRB     r5,[r4,#0xcd]         ;91
0000ba  e022              B        |L12.258|
                  |L12.188|
0000bc  f89400cc          LDRB     r0,[r4,#0xcc]         ;96
0000c0  1e40              SUBS     r0,r0,#1              ;96
0000c2  f88400cc          STRB     r0,[r4,#0xcc]         ;96
0000c6  e01c              B        |L12.258|
                  |L12.200|
0000c8  2500              MOVS     r5,#0                 ;103
0000ca  e003              B        |L12.212|
                  |L12.204|
0000cc  2000              MOVS     r0,#0                 ;103
0000ce  5560              STRB     r0,[r4,r5]            ;103
0000d0  1c68              ADDS     r0,r5,#1              ;103
0000d2  b2c5              UXTB     r5,r0                 ;103
                  |L12.212|
0000d4  f89400c8          LDRB     r0,[r4,#0xc8]         ;103
0000d8  42a8              CMP      r0,r5                 ;103
0000da  dcf7              BGT      |L12.204|
0000dc  2000              MOVS     r0,#0                 ;104
0000de  f8040fc8          STRB     r0,[r4,#0xc8]!        ;104
0000e2  7060              STRB     r0,[r4,#1]            ;105
0000e4  7160              STRB     r0,[r4,#5]            ;106
0000e6  f1a404c8          SUB      r4,r4,#0xc8           ;106
0000ea  f89d1000          LDRB     r1,[sp,#0]            ;108
0000ee  4806              LDR      r0,|L12.264|
0000f0  f7fffffe          BL       DeQueueBuf
0000f4  4805              LDR      r0,|L12.268|
0000f6  7880              LDRB     r0,[r0,#2]            ;110  ; Ir
0000f8  2801              CMP      r0,#1                 ;110
0000fa  d102              BNE      |L12.258|
0000fc  2000              MOVS     r0,#0                 ;110
0000fe  4903              LDR      r1,|L12.268|
000100  7088              STRB     r0,[r1,#2]            ;110
                  |L12.258|
000102  bf00              NOP      
000104  e783              B        |L12.14|
;;;113    //无线接收处理======================================================================================
                          ENDP

000106  0000              DCW      0x0000
                  |L12.264|
                          DCD      WirelessSend_Queue
                  |L12.268|
                          DCD      ||Ir||

                          AREA ||i.Wireless_Send_Check||, CODE, READONLY, ALIGN=2

                  Wireless_Send_Check PROC
;;;976    //无线设备和命令是否匹配
;;;977    uint8_t Wireless_Send_Check(uint8_t cmd,uint8_t index)
000000  4602              MOV      r2,r0
;;;978    {
;;;979    //	uint8_t rt;
;;;980    	
;;;981    	if((cmd==0x01)||(cmd==0x14))return 1;
000002  2a01              CMP      r2,#1
000004  d001              BEQ      |L13.10|
000006  2a14              CMP      r2,#0x14
000008  d101              BNE      |L13.14|
                  |L13.10|
00000a  2001              MOVS     r0,#1
                  |L13.12|
;;;982    	
;;;983    	//如果要转发通道的类型 遥控器，则退出
;;;984    	if(Ex_Table.Exchange[index].type>=EX_DEV_KEY)
;;;985    	{
;;;986    		return 0;	
;;;987    	}	
;;;988    	else
;;;989    	{
;;;990    //		if((Ex_Table.Exchange[index].type==EX_DEV_LIGHT)||(Ex_Table.Exchange[index].type==EX_DEV_SOCKET))
;;;991    //		{
;;;992    //			if((cmd!=0x07)&&(cmd!=0x08))
;;;993    //			{
;;;994    //				return 0;	
;;;995    //			}
;;;996    //		}
;;;997    //		else
;;;998    //		{
;;;999    //			if((cmd!=0x07)&&(cmd!=0x08)&&(cmd!=0x09)&&(cmd!=0x19))
;;;1000   //			{
;;;1001   //				return 0;	
;;;1002   //			}	
;;;1003   //		}	
;;;1004   	}
;;;1005   	return 1;
;;;1006   }
00000c  4770              BX       lr
                  |L13.14|
00000e  ebc103c1          RSB      r3,r1,r1,LSL #3       ;984
000012  4804              LDR      r0,|L13.36|
000014  f8100013          LDRB     r0,[r0,r3,LSL #1]     ;984
000018  28f0              CMP      r0,#0xf0              ;984
00001a  db01              BLT      |L13.32|
00001c  2000              MOVS     r0,#0                 ;986
00001e  e7f5              B        |L13.12|
                  |L13.32|
000020  2001              MOVS     r0,#1                 ;1005
000022  e7f3              B        |L13.12|
;;;1007   
                          ENDP

                  |L13.36|
                          DCD      Ex_Table+0x36

                          AREA ||i.WlLock_Learn_Finish||, CODE, READONLY, ALIGN=2

                  WlLock_Learn_Finish PROC
;;;716    //学习设备完成-遥控器
;;;717    void WlLock_Learn_Finish(void)
000000  b57c              PUSH     {r2-r6,lr}
;;;718    {
;;;719    			uint8_t index,i,buf[4];
;;;720    			index=lock.index;
000002  4828              LDR      r0,|L14.164|
000004  7805              LDRB     r5,[r0,#0]  ; lock
;;;721    			LockItem.addr[0]=wbuf[6];
000006  4828              LDR      r0,|L14.168|
000008  7980              LDRB     r0,[r0,#6]  ; wbuf
00000a  4928              LDR      r1,|L14.172|
00000c  7008              STRB     r0,[r1,#0]
;;;722    			LockItem.addr[1]=wbuf[7];
00000e  4826              LDR      r0,|L14.168|
000010  79c0              LDRB     r0,[r0,#7]  ; wbuf
000012  7048              STRB     r0,[r1,#1]
;;;723    			LockItem.addr[2]=wbuf[8];
000014  4824              LDR      r0,|L14.168|
000016  7a00              LDRB     r0,[r0,#8]  ; wbuf
000018  7088              STRB     r0,[r1,#2]
;;;724    			LockItem.addr[3]=wbuf[9];	
00001a  4823              LDR      r0,|L14.168|
00001c  7a40              LDRB     r0,[r0,#9]  ; wbuf
00001e  70c8              STRB     r0,[r1,#3]
;;;725    			LockItem.stu=0;
000020  2000              MOVS     r0,#0
000022  8288              STRH     r0,[r1,#0x14]
;;;726    			LockItem.safe=0;
000024  7148              STRB     r0,[r1,#5]
;;;727    			for(i=0;i<8;i++)LockItem.key[i]=0x31+i;
000026  2400              MOVS     r4,#0
000028  e007              B        |L14.58|
                  |L14.42|
00002a  f1040031          ADD      r0,r4,#0x31
00002e  b2c1              UXTB     r1,r0
000030  481e              LDR      r0,|L14.172|
000032  3009              ADDS     r0,r0,#9
000034  5501              STRB     r1,[r0,r4]
000036  1c60              ADDS     r0,r4,#1
000038  b2c4              UXTB     r4,r0
                  |L14.58|
00003a  2c08              CMP      r4,#8
00003c  dbf5              BLT      |L14.42|
;;;728    		  LockItem.key[6]=0xff;
00003e  21ff              MOVS     r1,#0xff
000040  481a              LDR      r0,|L14.172|
000042  73c1              STRB     r1,[r0,#0xf]
;;;729    	    LockItem.key[7]=0xff;
000044  7401              STRB     r1,[r0,#0x10]
;;;730    	    for(i=0;i<4;i++)buf[i]=wbuf[6+i];
000046  2400              MOVS     r4,#0
000048  e006              B        |L14.88|
                  |L14.74|
00004a  1da0              ADDS     r0,r4,#6
00004c  4916              LDR      r1,|L14.168|
00004e  5c08              LDRB     r0,[r1,r0]
000050  a901              ADD      r1,sp,#4
000052  5508              STRB     r0,[r1,r4]
000054  1c60              ADDS     r0,r4,#1
000056  b2c4              UXTB     r4,r0
                  |L14.88|
000058  2c04              CMP      r4,#4
00005a  dbf6              BLT      |L14.74|
;;;731    	    buf[3]&=0xf0;
00005c  f89d0007          LDRB     r0,[sp,#7]
000060  f00000f0          AND      r0,r0,#0xf0
000064  f88d0007          STRB     r0,[sp,#7]
;;;732    			LockItem.secret=GetSecret(&buf[0],4);
000068  2104              MOVS     r1,#4
00006a  a801              ADD      r0,sp,#4
00006c  f7fffffe          BL       GetSecret
000070  490e              LDR      r1,|L14.172|
000072  7108              STRB     r0,[r1,#4]
;;;733    			LockItem.sync=0;
000074  2000              MOVS     r0,#0
000076  8248              STRH     r0,[r1,#0x12]
;;;734    			//写入到锁转发表
;;;735    			Write_Lock_Table(index);
000078  4628              MOV      r0,r5
00007a  f7fffffe          BL       Write_Lock_Table
;;;736    
;;;737    			//============================================================================
;;;738    			//LED指示
;;;739    			Led_set(1,25,25,8,2);	
00007e  2002              MOVS     r0,#2
000080  2308              MOVS     r3,#8
000082  2219              MOVS     r2,#0x19
000084  4611              MOV      r1,r2
000086  9000              STR      r0,[sp,#0]
000088  2001              MOVS     r0,#1
00008a  f7fffffe          BL       Led_set
;;;740    			
;;;741    			Dev.learn_time=0;
00008e  2000              MOVS     r0,#0
000090  4907              LDR      r1,|L14.176|
000092  72c8              STRB     r0,[r1,#0xb]
;;;742    			Dev.encode_time=0;
000094  7308              STRB     r0,[r1,#0xc]
;;;743    			Dev.stu=DEV_NORMAL;
000096  2002              MOVS     r0,#2
000098  7188              STRB     r0,[r1,#6]
;;;744    			lock.SyncErr=0;
00009a  2000              MOVS     r0,#0
00009c  4901              LDR      r1,|L14.164|
00009e  72c8              STRB     r0,[r1,#0xb]
;;;745    }
0000a0  bd7c              POP      {r2-r6,pc}
;;;746    
                          ENDP

0000a2  0000              DCW      0x0000
                  |L14.164|
                          DCD      lock
                  |L14.168|
                          DCD      wbuf
                  |L14.172|
                          DCD      LockItem
                  |L14.176|
                          DCD      ||Dev||

                          AREA ||i.wl_test_send||, CODE, READONLY, ALIGN=2

                  wl_test_send PROC
;;;1157   //test
;;;1158   void wl_test_send(void)
000000  b510              PUSH     {r4,lr}
;;;1159   {
;;;1160   				_Frame *pws;
;;;1161   				//10 0A 07 00 00 00 00 49 0C 49 01 00 00 00 FB C0
;;;1162   		
;;;1163   				pws=GetQueue_InQ(&WirelessSend_Queue,0);	
000002  2100              MOVS     r1,#0
000004  481a              LDR      r0,|L15.112|
000006  f7fffffe          BL       GetQueue_InQ
00000a  4604              MOV      r4,r0
;;;1164   				if(pws==0)return;
00000c  b904              CBNZ     r4,|L15.16|
                  |L15.14|
;;;1165   							
;;;1166   				pws->buf[0]=0x10;
;;;1167   				pws->buf[1]=0x0a;
;;;1168   				pws->buf[2]=0x08;	
;;;1169   				pws->buf[3]=0x00;	
;;;1170   				pws->buf[4]=0x00;	
;;;1171   				pws->buf[5]=0x00;
;;;1172   				pws->buf[6]=0x00;
;;;1173   				pws->buf[7]=0x49;
;;;1174   				pws->buf[8]=0x0c;	
;;;1175   				pws->buf[9]=0x4a;	
;;;1176   				pws->buf[10]=0x01;	
;;;1177   				pws->buf[11]=0x00;
;;;1178   				pws->buf[12]=0x00;
;;;1179   				pws->buf[13]=0x00;
;;;1180   				pws->buf[14]=0xd0;
;;;1181   				pws->buf[15]=0xc2;
;;;1182   		
;;;1183   				pws->cnt=16;				   //发送总的字节数
;;;1184   				pws->flag=1;
;;;1185   				pws->resend=5;				 //重复上报三次	
;;;1186   				pws->rand=0;				   //第一次空闲既发送
;;;1187   				pws->ackwait=0;	
;;;1188   				EnQueueBuf(&WirelessSend_Queue,0);	
;;;1189   }
00000e  bd10              POP      {r4,pc}
                  |L15.16|
000010  2010              MOVS     r0,#0x10              ;1166
000012  7020              STRB     r0,[r4,#0]            ;1166
000014  200a              MOVS     r0,#0xa               ;1167
000016  7060              STRB     r0,[r4,#1]            ;1167
000018  2008              MOVS     r0,#8                 ;1168
00001a  70a0              STRB     r0,[r4,#2]            ;1168
00001c  2000              MOVS     r0,#0                 ;1169
00001e  70e0              STRB     r0,[r4,#3]            ;1169
000020  7120              STRB     r0,[r4,#4]            ;1170
000022  7160              STRB     r0,[r4,#5]            ;1171
000024  71a0              STRB     r0,[r4,#6]            ;1172
000026  2049              MOVS     r0,#0x49              ;1173
000028  71e0              STRB     r0,[r4,#7]            ;1173
00002a  200c              MOVS     r0,#0xc               ;1174
00002c  7220              STRB     r0,[r4,#8]            ;1174
00002e  204a              MOVS     r0,#0x4a              ;1175
000030  7260              STRB     r0,[r4,#9]            ;1175
000032  2001              MOVS     r0,#1                 ;1176
000034  72a0              STRB     r0,[r4,#0xa]          ;1176
000036  2000              MOVS     r0,#0                 ;1177
000038  72e0              STRB     r0,[r4,#0xb]          ;1177
00003a  7320              STRB     r0,[r4,#0xc]          ;1178
00003c  7360              STRB     r0,[r4,#0xd]          ;1179
00003e  20d0              MOVS     r0,#0xd0              ;1180
000040  73a0              STRB     r0,[r4,#0xe]          ;1180
000042  20c2              MOVS     r0,#0xc2              ;1181
000044  73e0              STRB     r0,[r4,#0xf]          ;1181
000046  2010              MOVS     r0,#0x10              ;1183
000048  f88400c8          STRB     r0,[r4,#0xc8]         ;1183
00004c  2001              MOVS     r0,#1                 ;1184
00004e  f88400c9          STRB     r0,[r4,#0xc9]         ;1184
000052  2005              MOVS     r0,#5                 ;1185
000054  f88400ca          STRB     r0,[r4,#0xca]         ;1185
000058  2000              MOVS     r0,#0                 ;1186
00005a  f88400cc          STRB     r0,[r4,#0xcc]         ;1186
00005e  f88400cd          STRB     r0,[r4,#0xcd]         ;1187
000062  2100              MOVS     r1,#0                 ;1188
000064  4802              LDR      r0,|L15.112|
000066  f7fffffe          BL       EnQueueBuf
00006a  bf00              NOP      
00006c  e7cf              B        |L15.14|
;;;1190   //============================================================================
                          ENDP

00006e  0000              DCW      0x0000
                  |L15.112|
                          DCD      WirelessSend_Queue

                          AREA ||i.wl_wakeup_frame||, CODE, READONLY, ALIGN=1

                  wl_wakeup_frame PROC
;;;1140   //=============================================================================================
;;;1141   void wl_wakeup_frame(uint8_t index)
000000  b538              PUSH     {r3-r5,lr}
;;;1142   {		
000002  4605              MOV      r5,r0
;;;1143   			uint8_t buf[3],len;
;;;1144   	
;;;1145   			buf[0]=0x55;
000004  2055              MOVS     r0,#0x55
000006  f88d0000          STRB     r0,[sp,#0]
;;;1146   			buf[1]=0x55;
00000a  f88d0001          STRB     r0,[sp,#1]
;;;1147   			len=2;
00000e  2402              MOVS     r4,#2
;;;1148   			#ifdef USE_A7139
;;;1149   			RF_TX1(buf,len);
000010  4621              MOV      r1,r4
000012  4668              MOV      r0,sp
000014  f7fffffe          BL       RF_TX1
;;;1150   			bsp_InitRF(1);
000018  2001              MOVS     r0,#1
00001a  f7fffffe          BL       bsp_InitRF
;;;1151   			#else
;;;1152   			RfSendPacket(buf,len);      //发送数据
;;;1153   			bsp_InitCC1101();
;;;1154   			#endif
;;;1155   }
00001e  bd38              POP      {r3-r5,pc}
;;;1156   //==============================================================================================
                          ENDP


                          AREA ||.bss||, DATA, NOINIT, ALIGN=0

                  wl_frame
                          %        16
                  wbuf
                          %        80

                          AREA ||.data||, DATA, ALIGN=1

                  dis_tim
000000  0000              DCB      0x00,0x00
                  CC1101_ResetTime
000002  0000              DCW      0x0000
                  step
000004  00                DCB      0x00

;*** Start embedded assembler ***

#line 1 "..\\..\\User\\App_Wireless.c"
	AREA ||.rev16_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___14_App_Wireless_c_b1da7e77____REV16|
#line 114 "..\\..\\Libraries\\CMSIS\\Include\\core_cmInstr.h"
|__asm___14_App_Wireless_c_b1da7e77____REV16| PROC
#line 115

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.revsh_text||, CODE, READONLY
	THUMB
	EXPORT |__asm___14_App_Wireless_c_b1da7e77____REVSH|
#line 128
|__asm___14_App_Wireless_c_b1da7e77____REVSH| PROC
#line 129

 revsh r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
